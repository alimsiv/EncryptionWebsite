{"version":3,"sources":["bit-handling-2.js","bit-handling.js","components/Nav.js","components/shared/page.js","pages/Home.js","pages/About.js","pages/vigenere-page.js","components/DES.js","components/shared/binary-display.js","components/shared/permutation-table.js","components/shared/utf-display.js","pages/des-page.js","pages/rsa-page.js","pages/md5-page.js","App.js","serviceWorker.js","index.js"],"names":["_","require","bitString","getBit","binary","index","i","length","parseInt","charAt","makeHalves","bits","Math","round","substring","joinPieces","left","right","fromHalves","module","exports","strToBits","str","charCodeAt","padStart","bitsToStr","charCodes","chunk","split","map","chunks","join","String","fromCharCode","code","setBit","original","value","AND","a","b","l","max","out","OR","XOR","leftShift","amount","repeat","circularLeftShift","Error","permutate","table","swapHalves","R","makePermutationTable","originalSize","permutedSize","options","extraOptions","push","floor","random","randomIndex","splice","invertPermutationTable","ignore","Set","inverted","has","add","selectionMask","rightSize","size","string","leftMostBit","shifted","number","leftMask","eachHalf","Nav","className","to","src","alt","type","data-toggle","data-target","id","Page","title","children","contentStyle","rest","style","marginTop","marginBottom","Home","Component","About","React","chars","VigenerePage","props","state","isToggleOn","message","key","result","cipher","cipherKey","clear","useAscii","scrollPos","selectChar","selectKeyChar","selectResultChar","selectCharInt","selectKeyCharInt","selectResultCharInt","handleClick","bind","handleChange","handleFormUpdate","handleScroll","e","preventDefault","console","log","target","this","setState","encrypt","updateScroll","decrypt","currentToggle","runUpdates","scrollInd","modNote","selectM","indexOf","encRes","keyIndex","keyChar","encoded","textAlign","Form","Group","controlId","Label","Control","onChange","placeholder","Text","Container","Row","Col","as","column","sm","Check","label","name","checked","Button","variant","onClick","Table","striped","bordered","hover","bitHandling","sBoxes","getSBoxes","expansionBox","L","keys","P","initialCallback","isInitialRound","expandedR0","xorWithKey","afterSBox","output","section","row","at","col","toString","sBoxBlock","permutatedBlock","xorWithLeft","BinaryDisplay","chunkSize","chunked","merge","fontFamily","fontSize","wordBreak","PermutationTable","showIndices","columns","rows","colSpan","r","bit","c","UTFDisplay","ascii","letters","bitCodes","cells","zip","letter","Fragment","DesPage","plaintext","encryptedBits","decryptedCiphertext","first64BitBlock","first64Bits","IP","afterInitialPermutation","L0","R0","afterExpansionBox","afterXorWithKey","permutationBox","afterPermutation","afterXorWithLeft","handleUpdate","doEncryption","Promise","resolve","prop","originalKey","PC1","PC2","NUM_LHS","initialPermutation","shifts","newKey","paddedMessage","originalBinary","FP","isSavedInState","isFirstRound","block","afterDESRounds","input","halvesCallback","halves","DESRounds","finalPermutation","binaryKey","generateKeys","addPadding","binaryMessage","encryptedBinary","encryptBlock","doDecryption","cipherbits","decryptedBinary","reverse","decryptedMessage","bitsToHex","hex","n","display","justifyContent","alignItems","Card","padding","trigger","triggerWhenOpen","whiteSpace","calc_n","p","q","calc_phi_n","gcd","t","isPrime","val","sqrt","RsaPage","useState","setP","setQ","setN","phi","setPhi","setE","d","setD","setMessage","ascii_encrypted","setASCIIencrypt","rsa_encrypted","setRSAencrypt","rsa_decrypted","setRSAdecrypt","ascii_decrypted","setASCIIdecrypt","useEffect","text","ascii_encrypt","N","Number","BigInt","rsa_encrypt","rsa_decrypt","ascii_decrypt","ListGroup","Item","event","isValid_e","res","count","generate_e","isValid_d","generate_d","md5cycleIterations","md5cycle","x","k","rotate_amounts","K","getDefaults","F","ff","gg","hh","ii","add32","collect","s","abs","sin","md5block","md5blocks","makeHex","hex_chr","md5","hash","tail","makeMD5","makeDisplayBlock","makePretty","arr","outer","split_result","zeros","j","final_result","replace","iterum","makeASCII","curHash","Md5Page","blocks","aCur","bCur","cCur","dCur","iterator","iteration","encodedPretty","warning","numIteration","disableButton","initials","next","temp","JSON","parse","stringify","nextIter","disabled","App","updateMe","info","login","basename","process","path","exact","render","component","Boolean","window","location","hostname","match","ReactDOM","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error"],"mappings":"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AAO,GAAK,CAAC,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,EACpC,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,EACpC,GAAG,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,GAAG,EACpC,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,IAChDA,EAAO,GAAK,CAAC,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,GACnC,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,GAAG,EACpC,GAAG,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EACpC,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,IAChDA,EAAO,GAAK,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,EACpC,GAAG,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,EACpC,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,GACnC,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,GACjDA,EAAO,GAAK,CAAC,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,GACnC,GAAG,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,EACpC,EAAE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","file":"static/js/main.be689836.chunk.js","sourcesContent":["const _ = require('lodash');\r\nconst { bitString } = require('./bit-handling');\r\n\r\n/**\r\n * Converts a string of text to a string of bits\r\n * @param {string} str Any text\r\n * @return {string} The charCodes of the characters in base 2\r\n */\r\nfunction strToBits(str) {\r\n    let bits = '';\r\n    for (let i = 0;i < str.length;i++) {\r\n        bits += bitString(str.charCodeAt(i), 16).padStart(16, '0');\r\n    }\r\n    return bits;\r\n}\r\n\r\n/**\r\n * Converts a string of bits back to text\r\n * @param {string} bits Char codes\r\n * @return {string} The text string corresponding to those character codes\r\n */\r\nfunction bitsToStr(bits) {\r\n    const charCodes = _.chunk(bits.split(''), 16).map(chunks => chunks.join(''));\r\n    return String.fromCharCode(...charCodes.map(code => parseInt(code, 2)));\r\n}\r\n\r\n/**\r\n * Gets the value of the bit at the specified index\r\n * @param {string} binary The binary string representation\r\n * @param {number} index The index of the bit to get (zero is rightmost bit)\r\n * @returns {number} The value of the specified bit\r\n */\r\nfunction getBit(binary, index) {\r\n    const i = binary.length - index - 1;\r\n    return parseInt(binary.charAt(i));\r\n}\r\n\r\n/**\r\n * Set the value of the bit at the specified index to `value`\r\n * @param {string} original The original bit string\r\n * @param {number} index The index of the bit to set (zero is rightmost)\r\n * @param {number} value The value to set the bit to\r\n * @returns {string} The new bitstring, with the appropriate bit set\r\n */\r\nfunction setBit(original, index, value) {\r\n    const i = original.length - index - 1;\r\n    return `${original.substring(0, i)}${value}${original.substring(i + 1)}`;\r\n}\r\n\r\nfunction AND(a, b) {\r\n    const l = Math.max(a.length, b.length);\r\n    a = a.padStart(l, '0');\r\n    b = b.padStart(l, '0');\r\n    let out = '';\r\n\r\n    for (let i = 0;i < l;i++) {\r\n        if (a.charAt(i) === '0' || b.charAt(i) === '0') {\r\n            out += '0';\r\n        } else {\r\n            out += '1';\r\n        }\r\n    }\r\n\r\n    return out;\r\n}\r\n\r\nfunction OR(a, b) {\r\n    const l = Math.max(a.length, b.length);\r\n    a = a.padStart(l, '0');\r\n    b = b.padStart(l, '0');\r\n    let out = '';\r\n\r\n    for (let i = 0;i < l;i++) {\r\n        if (a.charAt(i) === '1' || b.charAt(i) === '1') {\r\n            out += '1';\r\n        } else {\r\n            out += '0';\r\n        }\r\n    }\r\n\r\n    return out;\r\n}\r\n\r\nfunction XOR(a, b) {\r\n    const l = Math.max(a.length, b.length);\r\n    a = a.padStart(l, '0');\r\n    b = b.padStart(l, '0');\r\n    let out = '';\r\n\r\n    for (let i = 0;i < l;i++) {\r\n        if (a.charAt(i) !== b.charAt(i)) {\r\n            out += '1';\r\n        } else {\r\n            out += '0';\r\n        }\r\n    }\r\n\r\n    return out;\r\n}\r\n\r\nfunction leftShift(original, amount) {\r\n    return original + '0'.repeat(amount);\r\n}\r\n\r\n/**\r\n * Perform a circular left shift on a binary number\r\n * @param {string} original The original bitstring\r\n * @param {number} amount The number of left shifts\r\n * @return {string} The shifted bitstring\r\n */\r\nfunction circularLeftShift(original, amount) {\r\n    if (amount < 0) throw new Error('amount must be non-negative');\r\n    amount = amount % original.length;\r\n    if (amount === 0) return original;\r\n\r\n    return original.substring(amount) + original.substring(0, amount);\r\n}\r\n\r\n/**\r\n * Apply a permutation to a binary string, and return the result\r\n * @param {string} bits The original bits\r\n * @param {number[]} table The permutation table\r\n * @return {string} The permuted result\r\n */\r\nfunction permutate(bits, table) {\r\n    return table.map(i =>\r\n        getBit(bits, bits.length - i - 1))\r\n        .join('');\r\n}\r\n\r\nfunction makeHalves(bits) {\r\n    const length = Math.round(bits.length / 2);\r\n    return [bits.substring(0, length), bits.substring(length)];\r\n}\r\n\r\nfunction swapHalves(bits) {\r\n    const [R, L] = makeHalves(bits);\r\n    return fromHalves(L, R);\r\n}\r\n\r\nfunction joinPieces(left, right) {\r\n    return left + right;\r\n}\r\n\r\nfunction fromHalves(left, right) {\r\n    return joinPieces(left, right);\r\n}\r\n\r\nfunction makePermutationTable(originalSize, permutedSize) {\r\n    const options = [];\r\n    const extraOptions = [];\r\n    for (let i = 0;i < originalSize;i++) options.push(i);\r\n\r\n    if (permutedSize > originalSize) {\r\n        for (let i = 0;i < permutedSize - originalSize;i++) {\r\n            extraOptions.push(options[Math.floor(Math.random() * options.length)]);\r\n        }\r\n\r\n        options.push(...extraOptions);\r\n    }\r\n\r\n    const table = [];\r\n    for (let i = 0;i < permutedSize;i++) {\r\n        const randomIndex = Math.floor(Math.random() * options.length);\r\n        table.push(options.splice(randomIndex, 1)[0]);\r\n    }\r\n\r\n    return table;\r\n}\r\n\r\n// Not sure this works\r\nfunction invertPermutationTable(table) {\r\n    const ignore = new Set();\r\n    const inverted = [];\r\n\r\n    for (let i = 0;i < table.length;i++) {\r\n        if (ignore.has(table[i])) continue;\r\n        ignore.add(table[i]);\r\n        inverted[table[i]] = i;\r\n    }\r\n\r\n    return inverted;\r\n}\r\n\r\nmodule.exports = {\r\n    strToBits,\r\n    bitsToStr,\r\n    getBit,\r\n    setBit,\r\n    AND,\r\n    OR,\r\n    XOR,\r\n    leftShift,\r\n    circularLeftShift,\r\n    permutate,\r\n    makeHalves,\r\n    swapHalves,\r\n    joinPieces,\r\n    fromHalves,\r\n    makePermutationTable,\r\n    invertPermutationTable,\r\n};\r\n","// eslint-disable-next-line no-unused-vars\r\nfunction bitString(bits, size) {\r\n    let string = '';\r\n    for (let i = 0;i < size; i++) {\r\n        string = getBit(bits, i) + string;\r\n    }\r\n    return string;\r\n}\r\n\r\n/**\r\n * Gets the value of the bit at the specified index\r\n * @param {number} binary - The binary number\r\n * @param {number} index - The index of the bit to get (zero is rightmost bit)\r\n * @returns {number} The value of the specified bit\r\n */\r\nfunction getBit(binary, index) {\r\n    const selectionMask = 1 << index;\r\n    const overlapMask = binary & selectionMask;\r\n    return overlapMask >>> index;\r\n}\r\n\r\n/**\r\n * Set the value of the bit at the specified index to `value`\r\n * @param {number} original - The original number\r\n * @param {number} index - The index of the bit to set (zero is rightmost)\r\n * @param {number} value - The value to set the bit to\r\n * @returns {number} The new binary, with the appropriate bit set\r\n */\r\nfunction setBit(original, index, value) {\r\n    const selectionMask = 1 << index;\r\n\r\n    if (value === 1) {\r\n        return original | selectionMask;\r\n    } else {\r\n        return original & ~selectionMask;\r\n    }\r\n}\r\n\r\n/**\r\n * Perform a circular left shift on a binary number\r\n * @param {number} original - The original number\r\n * @param {number} size - The number of bits you are working with\r\n * @param {number} amount - The number of left shifts\r\n */\r\nfunction circularLeftShift(original, size, amount) {\r\n    if (amount < 0) throw new Error('amount must be non-negative');\r\n    if (amount === 0) return original;\r\n\r\n    const leftMostBit = getBit(original, size - 1);\r\n    let shifted = original << 1;\r\n    shifted = setBit(shifted, size, 0); // Clear the shifted bit\r\n    shifted = setBit(shifted, 0, leftMostBit); // Wrap it around\r\n    return circularLeftShift(shifted, size, amount - 1);\r\n}\r\n\r\n/**\r\n * Apply a permutation to a binary number, and return the result\r\n * @param {number} bits - The original bits\r\n * @param {number[]} table - The permutation table\r\n */\r\nfunction permutate(bits, table) {\r\n    let number = 0;\r\n\r\n    for (let i = 0; i < table.length; i++) {\r\n        const movingValue = getBit(bits, table[i]);\r\n        number = setBit(number, i, movingValue);\r\n    }\r\n\r\n    return number;\r\n}\r\n\r\nfunction makeHalves(bits, length) {\r\n    const leftMask = ~0b0 << (length / 2);\r\n    const rightMask = ~leftMask;\r\n    const leftHalf = (leftMask & bits) >>> (length / 2);\r\n    const rightHalf = rightMask & bits;\r\n    return [leftHalf, rightHalf];\r\n}\r\n\r\nfunction joinPieces(left, right, rightSize) {\r\n    return (left << rightSize) | right;\r\n}\r\n\r\nfunction fromHalves(left, right, eachHalf) {\r\n    return joinPieces(left, right, eachHalf);\r\n}\r\n\r\nmodule.exports = {\r\n    bitString,\r\n    getBit,\r\n    setBit,\r\n    circularLeftShift,\r\n    permutate,\r\n    makeHalves,\r\n    joinPieces,\r\n    fromHalves,\r\n}\r\n","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport './styling/Nav.css';\r\n//import './Styling/Boot.css';\r\n\r\n/**\r\n * Navigation Bar is generated here, uses Bootstrap and Reacter Router for links\r\n */\r\nfunction Nav() {\r\n  return (\r\n    <nav className='navbar navbar-expand-md'>\r\n      <div className='navbar-brand'>\r\n        <Link to='/'>\r\n          <div className='navImg'>\r\n            <img src='images/CWRUSecurityGrey.png' alt='Logo'></img>\r\n          </div>\r\n        </Link>\r\n      </div>\r\n      <button\r\n        className='navbar-toggler navbar-dark'\r\n        type='button'\r\n        data-toggle='collapse'\r\n        data-target='#main-navigation'\r\n      >\r\n        <span className='navbar-toggler-icon'></span>\r\n      </button>\r\n      <div className='collapse navbar-collapse' id='main-navigation'>\r\n        <ul className='navbar-nav'>\r\n          <li className='nav-item'>\r\n            <div className='nav-link'>\r\n              <Link to='/'>Home</Link>\r\n            </div>\r\n          </li>\r\n          <li className='nav-item'>\r\n            <div className='nav-link'>\r\n              <Link to='/about'>About</Link>\r\n            </div>\r\n          </li>\r\n          <li className='nav-item'>\r\n            <div className='nav-link'>\r\n              <Link to='/Vigenere'>Vigen&#232;re Cipher</Link>\r\n            </div>\r\n          </li>\r\n          <li className='nav-item'>\r\n            <div className='nav-link'>\r\n              <Link to='/DES'>DES</Link>\r\n            </div>\r\n          </li>\r\n          <li className='nav-item'>\r\n            <div className='nav-link'>\r\n              <Link to='/RSA'>RSA</Link>\r\n            </div>\r\n          </li>\r\n          <li className='nav-item'>\r\n            <div className='nav-link'>\r\n              <Link to='/MD5'>MD5</Link>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </nav>\r\n  );\r\n}\r\n\r\nexport default Nav;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Nav from \"../Nav\";\r\nimport '../styling/page.css';\r\n\r\n// Generic page wrapper\r\nconst Page = ({ title, children, contentStyle, ...rest }) => (\r\n    <div {...rest}>\r\n        <Nav />\r\n        <div className=\"container\" style={{ marginTop: 60, marginBottom: 120, ...contentStyle }}>\r\n            <h1>{title}</h1>\r\n            {children}\r\n        </div>\r\n    </div>\r\n);\r\n\r\nPage.propTypes = {\r\n    title: PropTypes.string,\r\n    children: PropTypes.node,\r\n    contentStyle: PropTypes.object,\r\n};\r\n\r\nexport default Page;\r\n","import React, { Component } from 'react'\r\nimport Page from \"../components/shared/page\";\r\n\r\nclass Home extends Component {\r\n    render() {\r\n        return (\r\n            <Page title=\"Home\">\r\n                CSDS 344: Computer Security \r\n                <br></br>\r\n                Final Project\r\n                <br></br>\r\n                Alessandra Sivilotti, Alex Neyman, Lucas Pham, \r\n                Lucas Popp, Jason Richards, Jacob Engelbrecht\r\n                <br></br>\r\n                <img src='images/CWRUSecurity.png' alt='Logo' style={{'width': '50%'}}></img>\r\n            </Page>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Home;\r\n","import React from 'react';\r\nimport Page from \"../components/shared/page\";\r\n\r\n/**\r\n * About Page Wrapper, relies on React Router for routing to here\r\n */\r\nclass About extends React.Component {\r\n   render() {\r\n      return (\r\n          <Page title=\"About\">\r\n              Might as well have an about page...\r\n          </Page>\r\n      )\r\n   }\r\n}\r\nexport default About;\r\n","import React from 'react';\r\nimport Page from \"../components/shared/page\";\r\nimport {Form, Row, Col, Container, Button, Table} from 'react-bootstrap';\r\n\r\nvar chars = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\",\r\n      \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\", \"q\", \"r\", \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\", \"A\", \"B\", \"C\", \"D\",\r\n      \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\",\r\n      \"!\", \"@\", \"#\", \"$\", \"%\", \"^\", \"&\", \"*\", \"(\", \")\", \"-\", \"=\", \"[\", \"]\", \";\", \"'\", \"\\\"\", \"\\\\\", \"|\", \":\", \"_\", \"+\",\r\n      \",\", \".\", \"<\", \">\", \"{\", \"}\", \"/\", \"?\", \"`\", \"~\", \" \"]\r\n\r\nclass VigenerePage extends React.Component {\r\n\r\n   constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n         isToggleOn: true,\r\n         message: \"\",\r\n         key: \"\",\r\n         result: \"\",\r\n         cipher: \"\",\r\n         cipherKey: \"\",\r\n         clear: \"\",\r\n         useAscii: false,\r\n         scrollPos: 0,\r\n         selectChar: \"\",\r\n         selectKeyChar: \"\", \r\n         selectResultChar: \"\", \r\n         selectCharInt: 0,\r\n         selectKeyCharInt: 0, \r\n         selectResultCharInt: 0, \r\n         \r\n      };\r\n\r\n      // This binding is necessary to make `this` work in the callback\r\n      this.handleClick = this.handleClick.bind(this);\r\n      this.handleChange = this.handleChange.bind(this);\r\n      this.handleFormUpdate = this.handleFormUpdate.bind(this);\r\n      this.handleScroll = this.handleScroll.bind(this);\r\n    }\r\n\r\n   handleClick(e) {\r\n      e.preventDefault();\r\n      console.log(e.target.id)\r\n      console.log(this.state.message);\r\n   }\r\n\r\n   handleFormUpdate(e) {\r\n      if(e.target.id === \"EncryptUpdate\") {\r\n         this.setState({message: e.target.value});\r\n         this.setState({result: this.encrypt(e.target.value, this.state.key)}, this.updateScroll)\r\n      }\r\n      else if (e.target.id === \"keyUpdate\") {\r\n         this.setState({key: e.target.value});\r\n         this.setState({result: this.encrypt(this.state.message, e.target.value)}, this.updateScroll)\r\n      }\r\n      else if(e.target.id === \"cipherUpdate\") {\r\n         this.setState({cipher: e.target.value});\r\n         this.setState({clear: this.decrypt(e.target.value, this.state.cipherKey)})\r\n      }\r\n      else if (e.target.id === \"cipheyKeyUpdate\") {\r\n         this.setState({cipherKey: e.target.value});\r\n         this.setState({clear: this.decrypt(this.state.cipher, e.target.value)})\r\n      }\r\n   }\r\n\r\n   handleChange(e) {\r\n      let currentToggle = this.state.useAscii\r\n      this.setState({useAscii: !currentToggle}, this.runUpdates)\r\n   }\r\n\r\n   runUpdates() {\r\n      this.setState({result: this.encrypt(this.state.message, this.state.key)})\r\n      this.setState({clear: this.decrypt(this.state.cipher, this.state.cipherKey)}, this.updateScroll)\r\n   }\r\n\r\n   updateScroll() {\r\n      let scrollInd = this.state.scrollPos\r\n      if(this.state.message.length === 0 || scrollInd < 0) {\r\n         this.setState({\r\n            selectChar: \"\",\r\n            selectKeyChar: \"\", \r\n            selectResultChar: \"\", \r\n            selectCharInt: 0,\r\n            selectKeyCharInt: 0, \r\n            selectResultCharInt: 0, \r\n            scrollPos: 0,\r\n            modNote: \"\"\r\n         })\r\n         return 1\r\n      }\r\n      if(scrollInd >= this.state.message.length) {\r\n         this.setState({scrollPos: this.state.message.length - 1}, this.updateScroll)\r\n      }\r\n      else {\r\n         let selectM = this.state.message[scrollInd]\r\n         this.setState({selectChar: selectM})\r\n         if (!this.state.useAscii) {\r\n            this.setState({selectCharInt: chars.indexOf(selectM)})\r\n         }\r\n         else {\r\n            this.setState({selectCharInt: selectM.charCodeAt(0)})\r\n         }\r\n         let encRes = \"\"\r\n         if (this.state.key.length === 0) {\r\n            this.setState({\r\n               selectKeyChar: \"\",\r\n               selectKeyCharInt: 0, \r\n            })\r\n            encRes = this.encrypt(selectM, \"\")\r\n            this.setState({selectResultChar: encRes})\r\n         }\r\n         else{\r\n            this.setState({selectKeyChar: this.state.key[scrollInd % this.state.key.length]})\r\n            encRes = this.encrypt(selectM, this.state.key[scrollInd % this.state.key.length])\r\n            this.setState({selectResultChar: encRes})\r\n            if (!this.state.useAscii) {\r\n               this.setState({selectKeyCharInt: chars.indexOf(this.state.key[scrollInd % this.state.key.length])})\r\n               if (chars.indexOf(this.state.key[scrollInd % this.state.key.length]) + chars.indexOf(selectM) > chars.length) {\r\n                  this.setState({modNote: \"*When the sum falls outside of the character list, it loops to the bottom!\"})\r\n               }\r\n               else {\r\n                  this.setState({modNote: \"\"})\r\n               }\r\n            }\r\n            else {\r\n               this.setState({selectKeyCharInt: this.state.key[scrollInd % this.state.key.length].charCodeAt(0)})\r\n               if (this.state.key[scrollInd % this.state.key.length].charCodeAt(0) + selectM.charCodeAt(0) > 127) {\r\n                  this.setState({modNote: \"*When the sum falls outside of the character list, it loops to the bottom!\"})\r\n               }\r\n               else {\r\n                  this.setState({modNote: \"\"})\r\n               }\r\n            }\r\n         }\r\n         if (!this.state.useAscii) {\r\n            this.setState({selectResultCharInt: chars.indexOf(encRes)})\r\n         }\r\n         else {\r\n            this.setState({selectResultCharInt: encRes.charCodeAt(0)})\r\n         }\r\n      }\r\n   }\r\n\r\n   handleScroll(e) {\r\n\r\n      let scrollInd = this.state.scrollPos\r\n      if(e.target.id === \"LeftSelect\") {\r\n         if (scrollInd !== 0) {\r\n            this.setState({scrollPos: scrollInd - 1}, this.updateScroll)\r\n         }\r\n      }\r\n      else if(e.target.id === \"RightSelect\") {\r\n         if (scrollInd <= this.state.message.length) {\r\n            this.setState({scrollPos: scrollInd + 1}, this.updateScroll)\r\n         }\r\n      }\r\n   }\r\n\r\n   encrypt(message, key) {\r\n\r\n      let result = \"\"\r\n\r\n      for(let i = 0; i < message.length; i++){\r\n         let index\r\n         if(this.state.useAscii) {\r\n            index = message[i].charCodeAt(0);\r\n         }\r\n         else {\r\n            index = chars.indexOf(message[i])\r\n         }\r\n         \r\n         if (index === -1)\r\n            return(\"Unrecognized Character in Message\")\r\n         let keyIndex = 0\r\n         if (key.length > 0) {\r\n            let keyChar = key[i % key.length]\r\n            if(this.state.useAscii) {\r\n               keyIndex = keyChar.charCodeAt(0);\r\n            }\r\n            else {\r\n               keyIndex = chars.indexOf(keyChar)\r\n            }\r\n            \r\n         }\r\n         if (keyIndex === -1)\r\n            return(\"Unrecognized Character in Key\")\r\n         if (this.state.useAscii) {\r\n            let encoded = (keyIndex + index) % 127\r\n            result += String.fromCharCode(encoded)\r\n         }\r\n         else {\r\n            let encoded = (keyIndex + index) % chars.length\r\n            result += chars[encoded]\r\n         }\r\n      }\r\n      return result\r\n   }\r\n\r\n   decrypt(cipher, key) {\r\n      let chars = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\",\r\n      \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\", \"q\", \"r\", \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\", \"A\", \"B\", \"C\", \"D\",\r\n      \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\",\r\n      \"!\", \"@\", \"#\", \"$\", \"%\", \"^\", \"&\", \"*\", \"(\", \")\", \"-\", \"=\", \"[\", \"]\", \";\", \"'\", \"\\\"\", \"\\\\\", \"|\", \":\", \"_\", \"+\",\r\n      \",\", \".\", \"<\", \">\", \"{\", \"}\", \"/\", \"?\", \"`\", \"~\", \" \"]\r\n\r\n      let result = \"\"\r\n\r\n      for(let i = 0; i < cipher.length; i++){\r\n         let index\r\n         if(this.state.useAscii) {\r\n            index = cipher[i].charCodeAt(0);\r\n         }\r\n         else {\r\n            index = chars.indexOf(cipher[i])\r\n         }\r\n         if (index === -1)\r\n            return(\"Unrecognized Character in the Cipher\")\r\n         let keyIndex = 0\r\n         if (key.length > 0) {\r\n            let keyChar = key[i % key.length]\r\n            if(this.state.useAscii) {\r\n               keyIndex = keyChar.charCodeAt(0);\r\n            }\r\n            else {\r\n               keyIndex = chars.indexOf(keyChar)\r\n            }\r\n         }\r\n         if (keyIndex === -1)\r\n            return(\"Unrecognized Character in Key\")\r\n         if(this.state.useAscii){\r\n            let encoded = (index - keyIndex + 127) % 127\r\n            result += String.fromCharCode(encoded)\r\n         }\r\n         else {\r\n            let encoded = (index - keyIndex + chars.length) % chars.length\r\n            //console.log(encoded)\r\n            result += chars[encoded]\r\n         }\r\n      }\r\n      return result\r\n   }\r\n\r\n   ord(string) {\r\n      return string.charCodeAt(0);\r\n   }\r\n\r\n\r\n   render() {\r\n      return (\r\n          <Page title=\"Vigen&#232;re Cipher\">\r\n             <p style={{textAlign: 'left'}}>The Vigen&#232;re Cipher is a modified version of the Caesar Cipher, where instead offset for the message being some fixed value, it is instead linked to a key \r\n                which contains many varying offsets. This key could be one value, making this a Caesar Cipher, or instead it could be the length of the message, a form of security \r\n                that is still sound today and used by Intelligence Agencies where agreed keys are known. Typically the key is somewhere between these two extremes, and looped for the\r\n                length of the message. The longer the key with respect to the message, the stronger the security of the cypher. When the key is too short, statistical attacks are \r\n                still valid attacks on the message.\r\n             </p>\r\n             <br></br>\r\n             <h3>Encryption!</h3>\r\n             <p style={{textAlign: 'left'}}>Enter a message and key to try it yourself!</p>\r\n             <Form>\r\n                <Form.Group controlId=\"EncryptUpdate\">\r\n                   <Form.Label>Message</Form.Label>\r\n                   <Form.Control type=\"text\" onChange={this.handleFormUpdate} placeholder=\"Message to Encrypy\" />\r\n                   <Form.Text className=\"text-muted\">\r\n                      This is the plain text information you want to share.\r\n                   </Form.Text>\r\n                </Form.Group>\r\n\r\n                <Form.Group controlId=\"keyUpdate\">\r\n                   <Form.Label>Key</Form.Label>\r\n                   <Form.Control type=\"text\" onChange={this.handleFormUpdate} placeholder=\"Any Length Key\" />\r\n                   <Form.Text className=\"text-muted\">\r\n                      This is the secret key both you and the recipient know.\r\n                   </Form.Text>\r\n                </Form.Group>\r\n             </Form>\r\n             <br></br>\r\n            <Container>\r\n               <Row>\r\n                  <Col>Encoded Message:</Col>\r\n                  <Col>\r\n                     <p>{this.state.result}</p>\r\n                  </Col>\r\n               </Row>\r\n            </Container>\r\n            <br></br>\r\n            <p style={{textAlign: 'left'}}>This encoded message could be transmitted to anyone who agrees on the numerical values of characters, and so long as they have \r\n            the key, they would be able to decrypt and read the original message. Typically, the difficult part of the internet security is agreeing on this key value. </p>\r\n             \r\n             <br></br>\r\n             <fieldset>\r\n               <Form.Group as={Row}>\r\n                  <Form.Label as=\"legend\" column sm={2}>\r\n                  Encoding Options\r\n                  </Form.Label>\r\n                  <Col sm={10}>\r\n                  <Form.Check\r\n                     type=\"radio\"\r\n                     label=\"Visual Character Set*\"\r\n                     name=\"formHorizontalRadios\"\r\n                     id=\"formHorizontalRadios1\"\r\n                     checked={!this.state.useAscii}\r\n                     onChange={this.handleChange}\r\n                  />\r\n                  <Form.Check\r\n                     type=\"radio\"\r\n                     label=\"ASCII\"\r\n                     name=\"formHorizontalRadios\"\r\n                     id=\"formHorizontalRadios2\"\r\n                     checked={this.state.useAscii}\r\n                     onChange={this.handleChange}\r\n                  />\r\n                  </Col>\r\n               </Form.Group>\r\n            </fieldset>\r\n            <p><small>This is just agreeing on a standard for character number relations</small></p>\r\n             <br></br>\r\n             <h3>Understanding the Encypytion Process!</h3>\r\n             <Container>\r\n                <Row>\r\n                   <Col sm={1}><br></br><br></br><Button id='LeftSelect' variant=\"secondary\" onClick={this.handleScroll}>Left</Button></Col>\r\n                  <Col>\r\n                     <Table striped bordered hover>\r\n                        <thead>\r\n                           <tr>\r\n                              <th>#</th>\r\n                              <th>String Form</th>\r\n                              <th>Integer Form</th>\r\n                           </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                           <tr>\r\n                              <td>Message Element</td>\r\n                              <td>{this.state.selectChar}</td>\r\n                              <td>{this.state.selectCharInt}</td>\r\n                           </tr>\r\n                           <tr>\r\n                              <td>Key Element</td>\r\n                              <td>{this.state.selectKeyChar}</td>\r\n                              <td>{this.state.selectKeyCharInt}</td>\r\n                           </tr>\r\n                           <tr>\r\n                              <td>Result</td>\r\n                              <td>{this.state.selectResultChar}</td>\r\n                              <td>{this.state.selectResultCharInt}</td>\r\n                           </tr>\r\n                        </tbody>\r\n                     </Table>\r\n                  </Col>\r\n                   <Col sm={1}><br></br><br></br><Button id='RightSelect' variant=\"secondary\" onClick={this.handleScroll}>Right</Button></Col>\r\n                </Row>\r\n             </Container>\r\n             <p><small>{this.state.modNote}</small></p>\r\n             <p style={{textAlign: 'left'}}>This table looks at the message letter by letter, communicating the string form of a character as you would see it, as well as the \r\n             number representation that goes along with it. This allows us to see that the result is just the character with the sum of the message value and the key value.</p>\r\n             <br></br>\r\n             <h3>Decryption</h3>\r\n             <p style={{textAlign: 'left'}}>\r\n                The decryption process is very similar, instead of adding the values of the message and the key, instead it subtracts the key value from the cypher value of that \r\n                character. Here you can see that you need to agree on the key value for the cypher text to have its meaning. \r\n             </p>\r\n             <Form>\r\n                <Form.Group controlId=\"cipherUpdate\">\r\n                   <Form.Label>Cypher</Form.Label>\r\n                   <Form.Control type=\"text\" onChange={this.handleFormUpdate} placeholder=\"The Cypher Text\" />\r\n                   <Form.Text className=\"text-muted\">\r\n                      This is the cypher text you received.\r\n                   </Form.Text>\r\n                </Form.Group>\r\n\r\n                <Form.Group controlId=\"cipheyKeyUpdate\">\r\n                   <Form.Label>Key</Form.Label>\r\n                   <Form.Control type=\"text\" onChange={this.handleFormUpdate} placeholder=\"Any Length Key\" />\r\n                   <Form.Text className=\"text-muted\">\r\n                      This is the secret key that was used to encrypt thie message.\r\n                   </Form.Text>\r\n                </Form.Group>\r\n             </Form>\r\n             <Container>\r\n               <Row>\r\n                  <Col>Decrypted Message:</Col>\r\n                  <Col>\r\n                     <p>{this.state.clear}</p>\r\n                  </Col>\r\n               </Row>\r\n            </Container>\r\n            <br></br>\r\n            <p style={{textAlign: 'left'}}>And just like that, the encrypted message is achievable again from a seemingly garbled message. You should always remember though\r\n            that this method has its weaknesses, especially when the messages grow in length compared to the key.</p>\r\n             <br></br>\r\n             <br></br>\r\n             <p><small>*Visual Character Set is a selected subset of characters that are all able to be rendered easily in browsers, opposed to ASCII. Not an industry standard.</small></p>\r\n          </Page>\r\n      )\r\n   }\r\n}\r\nexport default VigenerePage;\r\n","//import bitHandling from '../bit-handling-2';\r\nconst { bitHandling } = require('../bit-handling-2');\r\nconst _ = require('lodash');\r\n\r\n\r\nconst sBoxes = getSBoxes();\r\nconst expansionBox = [31,0,1,2,3,4,3,4,5,6,7,8,7,8,9,10,11,12,11,12,13,14,15,16,15,16,17,18,19,20,19,20,21,22,23,24,23,24,25,26,27,28,27,28,29,30,31,0];\r\n\r\nfunction getSBoxes() {\r\n    // Obtained from: https://www.oreilly.com/library/view/computer-security-and/9780471947837/sec9.3.html\r\n    // and https://www.nku.edu/~christensen/DESschneier.pdf\r\n    const sBoxes = [];\r\n    sBoxes[0] = [14,4,13,1,2,15,11,8,3,10,6,12,5,9,0,7,\r\n                 0,15,7,4,14,2,13,1,10,6,12,11,9,5,3,8,\r\n                 4,1,14,8,13,6,2,11,15,12,9,7,3,10,5,0,\r\n                 15,12,8,2,4,9,1,7,5,11,3,14,10,0,6,14];\r\n    sBoxes[1] = [15,1,8,14,6,11,3,4,9,7,2,13,12,0,5,10,\r\n                 3,13,4,7,15,2,8,14,12,0,1,10,6,9,11,5,\r\n                 0,14,7,11,10,4,13,1,5,8,12,6,9,3,2,15,\r\n                 13,8,10,1,3,15,4,2,11,6,7,12,0,5,14,9];\r\n    sBoxes[2] = [10,0,9,14,6,3,15,5,1,13,12,7,11,4,2,8,\r\n                 13,7,0,9,3,4,6,10,2,8,5,14,12,11,15,1,\r\n                 13,6,4,9,8,15,3,0,11,1,2,13,5,10,14,7,\r\n                 1,10,13,0,6,9,8,7,4,15,14,3,11,5,2,12];\r\n    sBoxes[3] = [7,13,14,3,0,6,9,10,1,2,8,5,11,12,4,15,\r\n                 13,8,11,5,6,15,0,3,4,7,2,12,1,10,14,9,\r\n                 10,6,9,0,12,11,7,13,15,1,3,14,5,2,8,4,\r\n                 3,15,0,6,10,1,13,8,9,4,5,11,12,7,2,14];\r\n    sBoxes[4] = [2,12,4,1,7,10,11,6,8,5,3,15,13,0,14,9,\r\n                 14,11,2,12,4,7,13,1,5,0,15,10,3,9,8,6,\r\n                 4,2,1,11,10,13,7,8,15,9,12,5,6,3,0,14,\r\n                 11,8,12,7,1,14,2,13,6,15,0,9,10,4,5,3];\r\n    sBoxes[5] = [12,1,10,15,9,2,6,8,0,13,3,4,14,7,5,11,\r\n                 10,15,4,2,7,12,9,5,6,1,13,14,0,11,3,8,\r\n                 9,14,15,5,2,8,12,3,7,0,4,10,1,13,11,6,\r\n                 4,3,2,12,9,5,15,10,11,14,1,7,6,0,8,13];\r\n    sBoxes[6] = [4,11,2,14,15,0,8,13,3,12,9,7,5,10,6,1,\r\n                 13,0,11,7,4,9,1,10,14,3,5,12,2,15,8,6,\r\n                 1,4,11,13,12,3,7,14,10,15,6,8,0,5,9,2,\r\n                 6,11,13,8,1,4,10,7,9,5,0,15,14,2,3,12];\r\n    sBoxes[7] = [13,2,8,4,6,15,11,1,10,9,3,14,5,0,12,7,\r\n                 1,15,13,8,10,3,7,4,12,5,6,11,0,14,9,2,\r\n                 7,11,4,1,9,12,14,2,0,6,10,13,15,3,5,8,\r\n                 2,1,14,7,4,10,8,13,15,12,9,0,3,5,6,11];\r\n    return sBoxes;\r\n }\r\n\r\nfunction sBoxBlock({bits, sBoxes}){\r\n    let output = \"\";\r\n    for (let i = 0; i < 8; i++){\r\n       const section = bits.substring(6*i, 6*i+6);\r\n       const row = parseInt(_.at(section,0) + _.at(section,5), 2);\r\n       const col = parseInt(section.substring(1,5), 2);\r\n       const newEntry = sBoxes[i][16*row + col];\r\n       output += newEntry.toString(2).padStart(4, \"0\");\r\n    }\r\n    return output;\r\n }\r\n\r\n function round({L, R, i, keys, P, initialCallback, isInitialRound}){\r\n     // Expand right size from 32 to 48 bits\r\n     const expandedR0 = bitHandling.permutate(R, expansionBox);\r\n\r\n     // XOR with sub-key i\r\n     const xorWithKey = bitHandling.XOR(expandedR0, keys[i]);\r\n\r\n     // S-boxes to shrink from 48 to 32 bits\r\n     const afterSBox = sBoxBlock({\r\n         bits: xorWithKey,\r\n         sBoxes,\r\n     });\r\n\r\n     // Permutation\r\n     const permutatedBlock = bitHandling.permutate(afterSBox, P);\r\n\r\n     // XOR with left side\r\n     const xorWithLeft = bitHandling.XOR(permutatedBlock, L);\r\n\r\n     if (isInitialRound){\r\n         console.log(\"first round\");\r\n         initialCallback(L, R, expandedR0, xorWithKey, afterSBox, permutatedBlock, xorWithLeft);\r\n     }\r\n\r\n     // Assign to new right side\r\n     return xorWithLeft;\r\n }\r\n\r\nfunction DESRounds({ input, keys, P, isFirstRound, initialCallback, halvesCallback }){\r\n    const halves = [];\r\n\r\n    // Does the 16 rounds of DES for a 64 bit block\r\n    let [L, R] = bitHandling.makeHalves(input);\r\n    let isInitialRound = isFirstRound;\r\n\r\n    // Add halves in each round for visualization purposes\r\n    halves.push([L, R]);\r\n\r\n    // Performs 16 rounds of DES\r\n    for (let i = 0; i < 16; i++){\r\n       [L, R] = [R, round({L, R, i, keys, P, initialCallback, isInitialRound})];\r\n       halves.push([L, R]);\r\n       isInitialRound = false;\r\n    }\r\n\r\n    halvesCallback && halvesCallback(halves);\r\n\r\n    return R + L;\r\n }\r\n\r\nexport {DESRounds, sBoxBlock, round, expansionBox, sBoxes};\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport Latex from 'react-latex';\r\n\r\nclass BinaryDisplay extends React.Component {\r\n    render() {\r\n        const binary = this.props.bits || '';\r\n        const chunkSize = this.props.chunkSize || binary.length;\r\n        const chunked = _.chunk(binary.split(''), chunkSize).map(bits => bits.join('')).join(' ');\r\n        const style = _.merge({}, { fontFamily: 'monospace', fontSize: '1.2rem' }, this.props.style);\r\n        return (\r\n            <div style={{ wordBreak: 'break-word' }}>\r\n                {this.props.label &&\r\n                    <Latex>{this.props.label}</Latex>}\r\n                    {this.props.label && ': '}\r\n                    <span style={style}>{chunked}</span>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default BinaryDisplay;\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport './permutation-table.css';\r\n\r\nconst PermutationTable = ({ title = 'Permutation Table', showIndices = true, table, columns }) => {\r\n    const rows = _.chunk(table, columns);\r\n\r\n    return (\r\n        <table className=\"permutation-table\">\r\n            <tbody>\r\n                <tr key=\"head\">\r\n                    <th colSpan={columns}>{title}</th>\r\n                </tr>\r\n                {rows.map((row, r) => (\r\n                    <tr key={r}>\r\n                        {row.map((bit, c) => (\r\n                            <td key={c}>\r\n                                {showIndices && <span className=\"index\">{(r * columns) + c + 1}</span>}\r\n                                <span className=\"permuted\">{bit}</span>\r\n                            </td>\r\n                        ))}\r\n                    </tr>\r\n                ))}\r\n            </tbody>\r\n        </table>\r\n    )\r\n}\r\n\r\nexport default PermutationTable;\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport './utf-display.css';\r\n//import bitHandling from \"../../bit-handling-2\";\r\nconst { bitHandling } = require('../../bit-handling-2');\r\n\r\n\r\nconst UTFDisplay = ({ ascii, columns }) => {\r\n    if (!columns) columns = ascii.length;\r\n    const letters = ascii.split('');\r\n    const bitCodes = _.chunk(bitHandling.strToBits(ascii).split(''), 16).map(bits => bits.join(''));\r\n    const cells = _.zip(letters, bitCodes).map(([letter, bits]) => ({ letter, bits }));\r\n    const rows = _.chunk(cells, columns);\r\n\r\n    return (\r\n        <div className=\"utf-display\">\r\n            <table>\r\n                <tbody>\r\n                    {rows.map((cells, r) => (\r\n                        <React.Fragment key={r}>\r\n                            <tr key={`${r}a`}>\r\n                                {cells.map(({ letter }, c) => (\r\n                                    <td key={c}>\r\n                                        <div className=\"index\">{(r * columns) + c + 1}</div>\r\n                                        <h1>{letter}</h1>\r\n                                    </td>\r\n                                ))}\r\n                            </tr>\r\n                            <tr key={`${r}b`}>\r\n                                {cells.map(({ bits }, c) => (\r\n                                    <td className=\"bits\" key={c}>\r\n                                        <div style={{ fontFamily: 'monospace' }}>\r\n                                            {bits}\r\n                                        </div>\r\n                                    </td>\r\n                                ))}\r\n                            </tr>\r\n                        </React.Fragment>\r\n                    ))}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    )\r\n}\r\n\r\nUTFDisplay.propTypes = {\r\n    ascii: PropTypes.string,\r\n    columns: PropTypes.number,\r\n};\r\n\r\nexport default UTFDisplay;\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport {Card, Form} from 'react-bootstrap';\r\nimport Button from 'react-bootstrap/Button'\r\nimport Collapsible from 'react-collapsible';\r\nimport {DESRounds, expansionBox, sBoxes} from '../components/DES';\r\nimport BinaryDisplay from \"../components/shared/binary-display\";\r\nimport PermutationTable from \"../components/shared/permutation-table\";\r\nimport Page from \"../components/shared/page\";\r\nimport UTFDisplay from \"../components/shared/utf-display\";\r\nimport Latex from 'react-latex';\r\nimport Table from \"react-bootstrap/Table\";\r\n//import bitHandling from '../bit-handling-2';\r\nconst { bitHandling } = require('../bit-handling-2');\r\n\r\n\r\n/**\r\n * About Page Wrapper, relies on React Router for routing to here\r\n */\r\nclass DesPage extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            isToggleOn: true,\r\n            plaintext: \"Hello world!\",\r\n            key: \"akey\",\r\n            encryptedBits: \"\",\r\n            decryptedCiphertext: \"\",\r\n            keys: [],\r\n            first64BitBlock: \"\",\r\n            first64Bits: \"\",\r\n            IP: [],\r\n            afterInitialPermutation: \"\",\r\n            L0: \"\",\r\n            R0: \"\",\r\n            afterExpansionBox: \"\",\r\n            afterXorWithKey: \"\",\r\n            afterSBox: \"\",\r\n            permutationBox: [],\r\n            afterPermutation: \"\",\r\n            afterXorWithLeft: \"\",\r\n        }\r\n\r\n        this.handleUpdate = this.handleUpdate.bind(this);\r\n        this.doEncryption = this.doEncryption.bind(this);\r\n    }\r\n\r\n    async setStateSync(state) {\r\n        return new Promise(resolve => this.setState(state, resolve));\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.doEncryption();\r\n    }\r\n\r\n    handleUpdate(prop, e) {\r\n        this.setState({[prop]: e.target.value});\r\n    }\r\n\r\n    generateKeys({originalKey, PC1, PC2}) {\r\n        const N_ROUNDS = 16;\r\n        const NUM_LHS = [1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1];\r\n\r\n        const keys = [];\r\n        const initialPermutation = bitHandling.permutate(originalKey, PC1);\r\n        let [left, right] = bitHandling.makeHalves(initialPermutation);\r\n\r\n        for (let round = 0; round < N_ROUNDS; round++) {\r\n            const shifts = NUM_LHS[round];\r\n            left = bitHandling.circularLeftShift(left, shifts);\r\n            right = bitHandling.circularLeftShift(right, shifts);\r\n\r\n            const newKey = bitHandling.permutate(bitHandling.fromHalves(left, right), PC2);\r\n            keys.push(newKey);\r\n        }\r\n\r\n        return keys;\r\n    }\r\n\r\n    addPadding(message) {\r\n        let paddedMessage = message;\r\n        while (paddedMessage.length % 4 !== 0) {\r\n            paddedMessage += \" \";\r\n        }\r\n        return paddedMessage;\r\n    }\r\n\r\n    encryptBlock({originalBinary, keys, IP, P, FP, isSavedInState}) {\r\n        // Encrypts each 64 bit block\r\n        const N_BITS = 64;\r\n        let output = \"\";\r\n        let isFirstRound = isSavedInState;\r\n\r\n        for (let block of _.chunk(originalBinary, N_BITS).map(b => b.join(''))) {\r\n            const initialPermutation = bitHandling.permutate(block, IP);\r\n\r\n            // 16 DES Rounds\r\n            const afterDESRounds = DESRounds({\r\n                input: initialPermutation,\r\n                keys,\r\n                P,\r\n                isFirstRound,\r\n                initialCallback: (L0, R0, expandedR0, xorWithKey, afterSBox, permutatedBlock, xorWithLeft) =>\r\n                    this.setState({\r\n                        afterInitialPermutation: initialPermutation,\r\n                        L0: L0,\r\n                        R0: R0,\r\n                        afterExpansionBox: expandedR0,\r\n                        afterXorWithKey: xorWithKey,\r\n                        afterSBox: afterSBox,\r\n                        afterPermutation: permutatedBlock,\r\n                        afterXorWithLeft: xorWithLeft\r\n                    }),\r\n                halvesCallback: isSavedInState ? (halves => this.setState({ halves })) : (() => {}),\r\n            });\r\n\r\n            isFirstRound = false;\r\n\r\n            const finalPermutation = bitHandling.permutate(afterDESRounds, FP);\r\n            output += finalPermutation;\r\n        }\r\n\r\n        return output;\r\n    }\r\n\r\n    doEncryption() {\r\n        // Generate the key\r\n        let binaryKey = bitHandling.strToBits(this.state.key.substring(0, 4));\r\n\r\n        const keys = this.generateKeys({\r\n            originalKey: binaryKey,\r\n            PC1: bitHandling.makePermutationTable(64, 56),\r\n            PC2: bitHandling.makePermutationTable(56, 48),\r\n        });\r\n\r\n        // Padding the plaintext message so that the message is composed of 64 bit sections (4 characters sections)\r\n        const paddedMessage = this.addPadding(this.state.plaintext);\r\n\r\n        // Generate the binary message\r\n        const binaryMessage = bitHandling.strToBits(paddedMessage);\r\n\r\n        console.log(`Original Message: ${binaryMessage}`);\r\n\r\n        const IP = [57, 49, 41, 33, 25, 17, 9, 1, 59, 51, 43, 35, 27, 19, 11, 3, 61, 53, 45, 37, 29, 21, 13, 5, 63, 55, 47, 39, 31, 23, 15, 7, 56, 48, 40, 32, 24, 16, 8, 0, 58, 50, 42, 34, 26, 18, 10, 2, 60, 52, 44, 36, 28, 20, 12, 4, 62, 54, 46, 38, 30, 22, 14, 6];\r\n        const P = bitHandling.makePermutationTable(32, 32);\r\n        const FP = [39, 7, 47, 15, 55, 23, 63, 31, 38, 6, 46, 14, 54, 22, 62, 30, 37, 5, 45, 13, 53, 21, 61, 29, 36, 4, 44, 12, 52, 20, 60, 28, 35, 3, 43, 11, 51, 19, 59, 27, 34, 2, 42, 10, 50, 18, 58, 26, 33, 1, 41, 9, 49, 17, 57, 25, 32, 0, 40, 8, 48, 16, 56, 24];\r\n\r\n        // Generate encrypted message\r\n        const encryptedBinary = this.encryptBlock({\r\n            originalBinary: binaryMessage,\r\n            keys,\r\n            IP,\r\n            P,\r\n            FP,\r\n            isSavedInState: true,\r\n        });\r\n\r\n        // Convert encrypted number to characters for the encrypted message\r\n        this.setState({\r\n            encryptedBits: encryptedBinary,\r\n            keys: keys,\r\n            first64BitBlock: paddedMessage.substring(0, 4),\r\n            first64Bits: bitHandling.strToBits(paddedMessage.substring(0, 4)),\r\n            IP: IP,\r\n            permutationBox: P\r\n        })\r\n\r\n        this.doDecryption({\r\n            cipherbits: encryptedBinary,\r\n            keys,\r\n            IP,\r\n            P,\r\n            FP,\r\n        });\r\n    }\r\n\r\n    doDecryption({cipherbits, keys, IP, FP, P}) {\r\n        const decryptedBinary = this.encryptBlock({\r\n            originalBinary: cipherbits,\r\n            keys: keys.reverse(),\r\n            IP,\r\n            P,\r\n            FP,\r\n            isSavedInState: false\r\n        });\r\n\r\n        const decryptedMessage = this.bitsToHex(decryptedBinary);\r\n        console.log(`Decrypted Message: ${decryptedMessage}`);\r\n        console.log(`Decrypted Message: ${bitHandling.bitsToStr(decryptedBinary)}`);\r\n        this.setState({\r\n            decryptedCiphertext: bitHandling.bitsToStr(decryptedBinary),\r\n        })\r\n    }\r\n\r\n    bitsToHex(bits) {\r\n        let hex = \"\";\r\n        for (let i = 0; i < bits.length; i = i + 16) {\r\n            hex += parseInt(bits.substring(i, i + 16), 2).toString(16).padStart(4, \"0\");\r\n        }\r\n        return hex;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Page title=\"DES\">\r\n                <div style={{textAlign: 'left'}}>\r\n                    <Form>\r\n                        <Form.Group controlId=\"EncryptUpdate\">\r\n                            <Form.Label>Message</Form.Label>\r\n                            <Form.Control type=\"text\" value={this.state.plaintext}\r\n                                          onChange={this.handleUpdate.bind(this, 'plaintext')}\r\n                                          placeholder=\"Message to Encrypt\"/>\r\n                            <Form.Text className=\"text-muted\">\r\n                                This is the plain text information you want to share.\r\n                            </Form.Text>\r\n                        </Form.Group>\r\n                        <Form.Group controlId=\"KeyControl\">\r\n                            <Form.Label>Key</Form.Label>\r\n                            <Form.Control type=\"text\" value={this.state.key}\r\n                                          onChange={this.handleUpdate.bind(this, 'key')}\r\n                                          placeholder=\"Key to Use\"/>\r\n                            <Form.Text className=\"text-muted\">\r\n                                The key to use (any string of 4 characters)\r\n                            </Form.Text>\r\n                        </Form.Group>\r\n                        <div style={{textAlign: 'center'}}>\r\n                            <Button variant=\"primary\" onClick={this.doEncryption}>\r\n                                Encrypt\r\n                            </Button>\r\n                        </div>\r\n                    </Form>\r\n                    <br/>\r\n                    <div className=\"section\">\r\n                        <h1>Key Generation</h1>\r\n                        <p>DES uses a 64-bit key to encrypt the plaintext message. This 64-bit key is used to generate\r\n                            16\r\n                            distinct 48-bit keys, which are used in series to encrypt the message.</p>\r\n                    </div>\r\n                    <div className=\"section\">\r\n                        <h3>Key Input</h3>\r\n                        <p>A 4-character string can be used as the 64-bit key because each character can be converted to\r\n                            a 16-bit UTF-16 character code. The key you provided is converted to a 64-bit binary value\r\n                            as shown below</p>\r\n                        <br/>\r\n                        <div style={{textAlign: 'center'}}>\r\n                            <UTFDisplay ascii={this.state.key.substring(0, 4)}/>\r\n                            <br/>\r\n                            <br/>\r\n                            <BinaryDisplay label=\"Your key\"\r\n                                           bits={bitHandling.strToBits(this.state.key.substring(0, 4))}/>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"section\">\r\n                        <h3>Generated Keys</h3>\r\n                        {this.state.keys.reverse().map((key, n) => (\r\n                            <BinaryDisplay\r\n                                key={n}\r\n                                label={`$K_{${n + 1}}$`}\r\n                                bits={key}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                    <div className=\"section\">\r\n                        <h1>Encryption</h1>\r\n                        <p>DES encrypts a message by separating it into 64-bit pieces, and encrypting them one-by-one.\r\n                            For a simple string, this means the message will be encrypted in blocks of four\r\n                            characters.</p>\r\n                        <p>The first block of your message is converted to bits as follows</p>\r\n                        <br/>\r\n                        <div style={{textAlign: 'center'}}>\r\n                            <UTFDisplay ascii={this.state.first64BitBlock}/>\r\n                            <br/>\r\n                            <br/>\r\n                            <BinaryDisplay label=\"Binary\" bits={this.state.first64Bits}/>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"section\">\r\n                        <h4>Algorithm Overview</h4>\r\n                        <p>\r\n                            <b>Initial Permutation</b>\r\n                            <br/>\r\n                            The first step in DES is to rearrange the bits in the first block using a permutation\r\n                            table, <Latex>$IP$</Latex>.\r\n                        </p>\r\n                        <p>\r\n                            <b>DES Rounds</b>\r\n                            <br/>\r\n                            The encryption process consists of 16 rounds, which correspond to the 16 generated keys.\r\n                            Before the first round, the message is split into left and right\r\n                            halves: <Latex>$L_0$</Latex> and <Latex>$R_0$</Latex>. Each round, the left and right hand\r\n                            sides are modified, so in\r\n                            the <Latex>$n$</Latex><sup>th</sup> round <Latex>$L_n$</Latex> and <Latex>$R_n$</Latex> are\r\n                            defined as…\r\n                        </p>\r\n                        <p style={{textAlign: 'center'}}>\r\n                            <div style={{display: 'inline-block', textAlign: 'left'}}>\r\n                                <Latex>{'$$L_n=R_{n-1}$$'}</Latex>\r\n                                <br/>\r\n                                <Latex>{'$$R_n=L_{n-1} \\\\oplus f(R_{n-1},K_n)$$'}</Latex>\r\n                            </div>\r\n                        </p>\r\n                        <p>where <Latex>$\\oplus$</Latex> is a bitwise XOR, and <Latex>$f$</Latex> is a function that\r\n                            scrambles <Latex>{`$R_{n-1}$`}</Latex> using <Latex>$K_n$</Latex>.</p>\r\n                        <p>\r\n                            <b>Final Permutation</b>\r\n                            <br/>\r\n                            <p>After the 16th round, the final 32-bit <Latex>{`$L_{16}$ and $R_{16}$`}</Latex> are\r\n                                swapped and joined back together into a 64-bit message. The bits of this message are\r\n                                rearranged\r\n                                again using another permutation table, <Latex>{`$IP^{-1}$`}</Latex>, which yields the\r\n                                final encrypted message!</p>\r\n                        </p>\r\n                        <p>\r\n                            <b>And… Repeat!</b>\r\n                            <br/>\r\n                            <p>This process is repeated for each 64-bit block of the message to encrypt the whole\r\n                                thing.</p>\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"section\">\r\n                        <h4>Initial Permutation <Latex>$(IP)$</Latex></h4>\r\n                        <p>Permutation is the act of mapping each input bit to a new output position. In this\r\n                            permutation, the input is 64 bits and the output is 64 bits, no bits are lost or created,\r\n                            instead each and every bit is mapped to a single new location. For example, since the first\r\n                            entry in the permutation table is {this.state.IP[0]}, the bit at that index in the input\r\n                            becomes the first bit of the output.</p>\r\n                        <div style={{display: 'flex', justifyContent: 'center', alignItems: 'center'}}>\r\n                            <Latex>$IP=$</Latex>&nbsp;\r\n                            <PermutationTable table={this.state.IP} columns={8}/>\r\n                        </div>\r\n                        <br/>\r\n                        <BinaryDisplay label=\"Before Permuting\" bits={this.state.first64Bits}/>\r\n                        <BinaryDisplay label=\"After Permuting\" bits={this.state.afterInitialPermutation}/>\r\n                    </div>\r\n                    <div className=\"section\">\r\n                        <h4>DES Rounds</h4>\r\n                        <p>This permuted message is then split into <Latex>$L_0$ and $R_0$</Latex>, as follows…</p>\r\n                        <p className=\"text-center\">\r\n                            <Latex>{`$\\\\underbrace{${this.state.L0}}_{L0}\\\\text{ }\\\\underbrace{${this.state.R0}}_{R0}$`}</Latex>\r\n                        </p>\r\n                        <br/>\r\n                        <p>After this, each <Latex>$L_n$</Latex> and <Latex>$R_n$</Latex> are computed as &nbsp;\r\n                            <Latex>{'$L_n=R_{n-1}$ and $R_n=L_{n-1} \\\\oplus f(R_{n-1},K_n)$.'}</Latex>\r\n                        </p>\r\n                        <p>This is repeated until <Latex>{'$L_{16}$ and $R_{16}$'}</Latex> are computed.</p>\r\n                        <Card style={{padding: '0.5em 1em'}}>\r\n                            <Collapsible trigger={<Latex>$f$ function (show more)</Latex>}\r\n                                         triggerWhenOpen={<Latex>$f$ function (hide)</Latex>}>\r\n                                <div className=\"section\">\r\n                                    <p><b>Overview of f function</b>\r\n                                        <br/>\r\n                                        The f function takes the right side of the 64-bit input, expands it to 48 bits,\r\n                                        XORs it with the corresponding key, shrinks it back down to 32 bits, permutates\r\n                                        the bits, and XORs it with the left side. This is done 16 times.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"section\">\r\n                                    <p><b>Expansion Box</b>\r\n                                        <br/>\r\n                                        This operation expands <Latex>$R_i$</Latex> from 32 bits to 48 bits. This done\r\n                                        by\r\n                                        using this permutation table to repeat certain bits in order to make the right\r\n                                        side\r\n                                        longer.\r\n                                    </p>\r\n                                    <div style={{display: 'flex', justifyContent: 'center', alignItems: 'center'}}>\r\n                                        <Latex>Expansion Permutation$=$</Latex>&nbsp;\r\n                                        <PermutationTable table={expansionBox} columns={8}/>\r\n                                    </div>\r\n                                    <p><BinaryDisplay label=\"Initial Right Side\" bits={this.state.R0}/></p>\r\n                                    <p><BinaryDisplay label=\"After Expansion\" bits={this.state.afterExpansionBox}/></p>\r\n                                </div>\r\n                                <div className=\"section\">\r\n                                    <p><b>XOR</b>\r\n                                        <br/>\r\n                                        The bits are then XORed with the key corresponding to that round. For example,\r\n                                        in the\r\n                                        first round, the bits will be XORed with <Latex>{`$K_1$`}</Latex>, then with\r\n                                        <Latex>{` $K_2$`}</Latex> in the second round, and so forth, until XORing with\r\n                                        <Latex>{` $K_{16}$`}</Latex> in the last round.</p>\r\n                                    <p><BinaryDisplay label=\"The First Key\" bits={this.state.keys[0]}/></p>\r\n                                    <p><BinaryDisplay label=\"After XOR\" bits={this.state.afterXorWithKey}/></p>\r\n                                </div>\r\n                                <div className=\"section\">\r\n                                    <p><b>S-Box Substitution</b></p>\r\n                                    <Card style={{padding: '0.5em 1em'}}>\r\n                                        <Collapsible trigger=\"(show more)\"\r\n                                                     triggerWhenOpen=\"(hide)\">\r\n                                            <p>The S-Box Substitution takes the 48 bit output for the XOR with the key,\r\n                                                and\r\n                                                shrinks it back down to 32 bits. This operation is done by separating\r\n                                                the 48\r\n                                                bits into 8 6-bit block. There are 8 corresponding S-Boxes, which are\r\n                                                each\r\n                                                a 4 by 16 table of 4-bit entries. Each of the 6-bit input blocks is\r\n                                                operated\r\n                                                on by a separate S-box, for example, the first block uses the first\r\n                                                S-Box,\r\n                                                and so forth. The bits in the input block specify the output entry in\r\n                                                the\r\n                                                S-Box table. For an input block of <Latex>$b_1$, $b_2$, $b_3$, $b_4$,\r\n                                                    $b_5$,\r\n                                                    $b_6$</Latex>, the bits <Latex>$b_1$ and $b_6$</Latex> corresponds\r\n                                                to\r\n                                                the row number of the table, while the bits <Latex>$b_2$, $b_3$, $b_4$,\r\n                                                    $b_5$</Latex> denote the column number. The 4-bit output is\r\n                                                retrieved\r\n                                                for the S-Box table using this row and column number. This is repeated\r\n                                                for\r\n                                                all 8 blocks.</p>\r\n                                            <p><BinaryDisplay label=\"First 6 bits of input\"\r\n                                                              bits={this.state.afterXorWithKey.substring(0, 6)}/></p>\r\n                                            <p><BinaryDisplay label=\"Row (formed with the first and last bit of the\r\n                                                input)\"\r\n                                                              bits={this.state.afterXorWithKey.charAt(0) + this.state.afterXorWithKey.charAt(5)}/>\r\n                                            </p>\r\n                                            <p><BinaryDisplay label=\"Column (formed with the middle 4 bits of the\r\n                                                input)\" bits={this.state.afterXorWithKey.substring(1, 5)}/></p>\r\n                                            <p>Using the row and column calculated above, the corresponding table entry\r\n                                                at\r\n                                                that location is the new output.</p>\r\n                                            <div style={{\r\n                                                display: 'flex',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center'\r\n                                            }}>\r\n                                                <Latex>S-Box$=$</Latex>&nbsp;\r\n                                                <PermutationTable table={sBoxes[0]} columns={16} showIndices={false}/>\r\n                                            </div>\r\n                                            <p>The row and column correspond to the entry of value\r\n                                                <Latex>{` ${parseInt(this.state.afterSBox.substring(0, 4), 2)}. `}</Latex>\r\n                                                This is converted to binary to become the output. </p>\r\n                                            <p><BinaryDisplay label=\"Output\"\r\n                                                              bits={this.state.afterSBox.substring(0, 4)}/></p>\r\n                                        </Collapsible>\r\n                                    </Card>\r\n                                </div>\r\n                                <div className=\"section\">\r\n                                    <p><b>Permutation</b>\r\n                                        <br/>\r\n                                        The bits are then permutated again with a different permutation table.</p>\r\n                                    <div style={{display: 'flex', justifyContent: 'center', alignItems: 'center'}}>\r\n                                        <Latex>$P=$</Latex>&nbsp;\r\n                                        <PermutationTable table={this.state.permutationBox} columns={8}/>\r\n                                    </div>\r\n                                    <p><BinaryDisplay label=\"After Permutation\" bits={this.state.afterPermutation}/></p>\r\n                                </div>\r\n                                <div className=\"section\">\r\n                                    <p><b>XOR</b>\r\n                                        <br/>\r\n                                        It is then XORed with the initial left side. This produces the right side for\r\n                                        the next round.\r\n                                        <BinaryDisplay label=\"After XOR\" bits={this.state.afterXorWithLeft}/></p>\r\n                                </div>\r\n                                <p className=\"text-center\">\r\n                                    <Latex>{`$\\\\underbrace{${this.state.R0}}_{L1}\\\\text{ }\\\\underbrace{${this.state.afterXorWithLeft}}_{R1}$`}</Latex>\r\n                                </p>\r\n                                <div className=\"section\">\r\n                                    <p>\r\n                                        <b>And… Repeat!</b>\r\n                                        <br/>\r\n                                        <p>This process is repeated another 15 times to complete the 16 rounds of DES\r\n                                            encryption.</p>\r\n                                    </p>\r\n                                </div>\r\n                            </Collapsible>\r\n                        </Card>\r\n                        <br/>\r\n                        <Card style={{padding: '0.5em 1em'}}>\r\n                            <Collapsible trigger=\"See the results of the DES rounds\" triggerWhenOpen=\"Hide\">\r\n                                {(this.state.halves || []).map(([L, R], n) => (\r\n                                    <p className=\"text-center\" key={n}>\r\n                                        <Latex>{`$\\\\underbrace{${L}}_{L_{${n}}}\\\\text{ }\\\\underbrace{${R}}_{R_{${n}}}$`}</Latex>\r\n                                    </p>\r\n                                ))}\r\n                            </Collapsible>\r\n                        </Card>\r\n                        <br />\r\n                    </div>\r\n                    <div>\r\n                        <h4>Final Permutation</h4>\r\n                        <p>\r\n                            <Latex>{'$L_{16}$ and $R_{16}$'}</Latex> are then combined, and permuted using the final\r\n                            permutation table <Latex>{'$IP^{-1}$'}</Latex>, which yields the final encrypted message.\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"section\">\r\n                        <h1>Results</h1>\r\n                        <Table bordered>\r\n                            <thead>\r\n                            <tr>\r\n                                <th />\r\n                                <th>Input</th>\r\n                                <th>Output</th>\r\n                            </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                            <tr>\r\n                                <td><span style={{ whiteSpace: 'nowrap' }}>UTF-8</span></td>\r\n                                <td>{this.state.plaintext}</td>\r\n                                <td>{bitHandling.bitsToStr(this.state.encryptedBits)}</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>Hex</td>\r\n                                <td style={{ wordBreak: 'break-word' }}>{this.bitsToHex(bitHandling.strToBits(this.state.plaintext))}</td>\r\n                                <td style={{ wordBreak: 'break-word' }}>{this.bitsToHex(this.state.encryptedBits)}</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>Binary</td>\r\n                                <td style={{ fontFamily: 'monospace', fontSize: '0.8rem', wordBreak: 'break-word' }}>\r\n                                    {bitHandling.strToBits(this.state.plaintext)}\r\n                                </td>\r\n                                <td style={{ fontFamily: 'monospace', fontSize: '0.8rem', wordBreak: 'break-word' }}>\r\n                                    {this.state.encryptedBits}\r\n                                </td>\r\n                            </tr>\r\n                            </tbody>\r\n                        </Table>\r\n                    </div>\r\n                    <div className=\"section\">\r\n                        <h1>Decryption</h1>\r\n                        <p>DES decrypts a message using the same algorithm in the same order, but with the keys in\r\n                            reverse.\r\n                            In other words, if the encryption keys\r\n                            are <br/><Latex>{'$K_1$, $K_2$, $K_3$,...,$K_{16}$'}</Latex>,\r\n                            then the decryption keys are <Latex>{'$K_{16}$, $K_{15}$, $K_{14}$,...,$K_1$'}</Latex>.\r\n                            Whereas before the plaintext message and the keys were inputted and the ciphertext was the\r\n                            result,\r\n                            now the ciphertext and the reversed keys are inputted and the original plaintext message is\r\n                            the result. </p>\r\n                        <br/>\r\n                        <p>The decrypted message: <b>{this.state.decryptedCiphertext}</b></p>\r\n                    </div>\r\n                </div>\r\n            </Page>\r\n        )\r\n    }\r\n}\r\n\r\nexport default DesPage;\r\n","/* eslint-disable */\r\nimport React, {useEffect, useState} from 'react';\r\nimport Page from '../components/shared/page';\r\nimport Nav from '../components/Nav';\r\nimport '../components/styling/RSA.css';\r\nimport {ListGroup, Form} from 'react-bootstrap';\r\nimport Latex from 'react-latex';\r\n\r\n/**\r\n * About Page Wrapper, relies on React Router for routing to here\r\n */\r\n\r\n/* global BigInt */\r\nfunction ascii_encrypt(message) {\r\n    var i;\r\n    var text = \"\";\r\n    for (i = 0; i < message.length; i++) {\r\n        text += message.charCodeAt(i) + \" \";\r\n    }\r\n    text = text.substring(0, text.length - 1);\r\n    return text;\r\n}\r\n\r\nfunction ascii_decrypt(message) {\r\n    message = message.split(' ');\r\n    var i;\r\n    var text = '';\r\n    for (i = 0; i < message.length; i++) {\r\n        text += String.fromCharCode(parseInt(message[i]));\r\n    }\r\n    return text;\r\n}\r\n\r\nfunction calc_n(p, q) {\r\n    return p * q;\r\n}\r\n\r\nfunction calc_phi_n(p, q) {\r\n    return (p - 1) * (q - 1);\r\n}\r\n\r\n// Assume input message is ascii encrypted\r\nfunction rsa_encrypt(message, e, N) {\r\n    if (message === '' || N === 0) {\r\n        return ''\r\n    }\r\n    message = message.split(' ');\r\n    var i;\r\n    var text = \"\";\r\n    for (i = 0; i < message.length; i++) {\r\n        text += Number((BigInt(parseInt(message[i])) ** BigInt(e)) % BigInt(N)) + ' ';\r\n    }\r\n    text = text.substring(0, text.length - 1);\r\n    return text;\r\n}\r\n\r\n// Assume input message is rsa encrypted (message = c)\r\nfunction rsa_decrypt(message, d, N) {\r\n    if (message === '' || N === 0) {\r\n        return ''\r\n    }\r\n    message = message.split(' ');\r\n    var i;\r\n    var text = \"\";\r\n    for (i = 0; i < message.length; i++) {\r\n        text += Number((BigInt(parseInt(message[i])) ** BigInt(d)) % BigInt(N)) + ' ';\r\n    }\r\n    text = text.substring(0, text.length - 1);\r\n    return text;\r\n}\r\n\r\n// console.log('I aint never seen 2 pretty best friends');\r\n// console.log(ascii_encrypt('I aint never seen 2 pretty best friends'));\r\n// console.log(rsa_encrypt(ascii_encrypt('I aint never seen 2 pretty best friends'), 47, 3127));\r\n// console.log(rsa_decrypt(rsa_encrypt(ascii_encrypt('I aint never seen 2 pretty best friends'), 47, 3127), 2631, 3127));\r\n// console.log(ascii_decrypt(rsa_decrypt(rsa_encrypt(ascii_encrypt('I aint never seen 2 pretty best friends'), 47, 3127), 2631, 3127)));\r\n\r\nfunction gcd(a, b) {\r\n    if ((typeof a !== 'number') || (typeof a !== 'number'))\r\n        return false;\r\n    while (b) {\r\n        var t = b;\r\n        b = a % b;\r\n        a = t;\r\n    }\r\n    return a;\r\n}\r\n\r\nfunction isPrime(val) {\r\n    if (val == 0) {\r\n        return ''\r\n    }\r\n\r\n    for (var i = 2; i <= Math.sqrt(val); i++) {\r\n        if (val % i === 0) {\r\n            return 'Invalid value';\r\n        }\r\n    }\r\n\r\n    if (val > 1) {\r\n        return 'Valid value';\r\n    } else {\r\n        return 'Invalid value';\r\n    }\r\n}\r\n\r\nfunction isValid_e(e, p, q) {\r\n    if (e == 0 || p == 0 || q == 0) {\r\n        return '';\r\n    }\r\n\r\n    var N = calc_n(p, q);\r\n    var phi = calc_phi_n(p, q);\r\n    if (e <= 1 || e >= phi) {\r\n        return 'Invalid value';\r\n    } else if (gcd(e, N) > 1) {\r\n        return 'Invalid value';\r\n    } else if (gcd(e, phi) > 1) {\r\n        return 'Invalid value';\r\n    } else {\r\n        return 'Valid value';\r\n    }\r\n}\r\n\r\nfunction generate_e(p, q) {\r\n    if (p == 0 || q == 0) {\r\n        return '';\r\n    }\r\n    var N = calc_n(p, q);\r\n    var phi = calc_phi_n(p, q);\r\n    var res = \"\";\r\n    var i;\r\n\r\n    let count = phi < 1000 ? phi : 1000\r\n\r\n    for (i = 2; i < count; i++) {\r\n        if (gcd(i, N) > 1 || gcd(i, phi) > 1) {\r\n            continue\r\n        } else {\r\n            res += i.toString() + \", \";\r\n        }\r\n    }\r\n    return res\r\n}\r\n\r\nfunction isValid_d(d, e, p, q) {\r\n    if (d == 0 || e == 0 || p == 0 || q == 0) {\r\n        return '';\r\n    }\r\n\r\n    var phi = calc_phi_n(p, q);\r\n    var mod = (d * e) % phi;\r\n    if (mod === 1) {\r\n        return 'Valid value';\r\n    } else {\r\n        return 'Invalid value';\r\n    }\r\n}\r\n\r\nfunction generate_d(e, p, q) {\r\n    if (e == 0 || p == 0 || q == 0) {\r\n        return '';\r\n    }\r\n\r\n    var phi = calc_phi_n(p, q);\r\n    var res = \"\";\r\n    var i;\r\n\r\n    for (i = 1; i < 5*phi; i++) {\r\n        var mod = (i * e) % phi;\r\n\r\n        if (mod === 1) {\r\n            res += i.toString() + \", \";\r\n        } else {\r\n            continue;\r\n        }\r\n    }\r\n\r\n    return res;\r\n}\r\n\r\nconst RsaPage = () => {\r\n\r\n    // keeps track of p and q values and uses set function in inputs\r\n    const [p, setP] = useState('');\r\n    const [q, setQ] = useState('');\r\n    const [n, setN] = useState('');\r\n    const [phi, setPhi] = useState('');\r\n    const [e, setE] = useState('');\r\n    const [d, setD] = useState('');\r\n    const [message, setMessage] = useState('');\r\n    const [ascii_encrypted, setASCIIencrypt] = useState('');\r\n    const [rsa_encrypted, setRSAencrypt] = useState('');\r\n    const [rsa_decrypted, setRSAdecrypt] = useState('');\r\n    const [ascii_decrypted, setASCIIdecrypt] = useState('');\r\n\r\n\r\n    // only called when p or q changes, updates n using the function\r\n    useEffect(() => {\r\n        setN(calc_n(p, q))\r\n    }, [p, q])\r\n\r\n    useEffect(() => {\r\n        setPhi(calc_phi_n(p, q))\r\n    }, [p, q])\r\n\r\n    useEffect(() => {\r\n        setASCIIencrypt(ascii_encrypt(message))\r\n    }, [message])\r\n\r\n    useEffect(() => {\r\n        setRSAencrypt(rsa_encrypt(ascii_encrypted, e, n))\r\n    }, [ascii_encrypted, e, n])\r\n\r\n    useEffect(() => {\r\n        setRSAdecrypt(rsa_decrypt(rsa_encrypted, d, n))\r\n    }, [rsa_encrypted, d, n])\r\n\r\n    useEffect(() => {\r\n        setASCIIdecrypt(ascii_decrypt(rsa_decrypted))\r\n    }, [rsa_decrypted])\r\n\r\n    return (\r\n        <Page title=\"RSA\">\r\n            <ListGroup className='steps'>\r\n                <h2>Key Generation</h2>\r\n                <ListGroup.Item>\r\n                    <p>\r\n                        <Latex>Receiver (decryptor) picks two prime numbers: $(p, q)$</Latex>\r\n                    </p>\r\n                    <div className='user-input'>\r\n                        <Form.Group className='form-inline'>\r\n                            <Form.Label>\r\n                                <Latex>$p:\\ $ </Latex>\r\n                            </Form.Label>\r\n                            <Form.Control type='number' placeholder='enter p' value={p}\r\n                                          onChange={event => setP(event.target.value)}/>\r\n                        </Form.Group>\r\n                        <p>{isPrime(p)}</p>\r\n\r\n                        <Form.Group className='form-inline'>\r\n                            <Form.Label>\r\n                                <Latex>$q:\\ $ </Latex>\r\n                            </Form.Label>\r\n                            <Form.Control type='number' placeholder='enter q' value={q}\r\n                                          onChange={event => setQ(event.target.value)}/>\r\n                        </Form.Group>\r\n                        <p>{isPrime(q)}</p>\r\n\r\n                    </div>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item>\r\n                    <p>The product of p and q will become half of the public key</p>\r\n                    <p>\r\n                        <Latex>We calculate $n = p \\times q$:</Latex>\r\n                    </p>\r\n                    <p>\r\n                        <Latex>$n =\\ $</Latex>\r\n                        {n}\r\n                    </p>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item>\r\n                    <p>\r\n                        <p>Using Euler's Totient Function, we calculate <Latex>$\\phi(n)$</Latex> which is the number of positive integers less than n that are coprime to n.</p>\r\n                        <strong>\r\n                            <Latex>$\\phi$ function: </Latex>\r\n                        </strong>\r\n                        <Latex>Calcute $\\phi(n) = (p-1)(q-1)$</Latex>\r\n                    </p>\r\n                    <p>\r\n                        <Latex>$\\phi(n) =\\ $</Latex>\r\n                        {phi}\r\n                    </p>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item>\r\n                    <p>\r\n                        A number <em>e</em> is a relatively prime number to <Latex>$\\phi$(n)</Latex> that will be the other half of the public key\r\n                    </p>\r\n                    <p>\r\n                        <Latex>Receiver (decryptor) picks encryption number e: </Latex>\r\n                    </p>\r\n                    {/* Use isValid_e here */}\r\n                    <div className='user-input'>\r\n                        <Form.Group className='form-inline'>\r\n                            <Form.Label>\r\n                                <Latex>$e:\\ $ </Latex>\r\n                            </Form.Label>\r\n                            <Form.Control type='number' placeholder='enter e' value={e}\r\n                                          onChange={event => setE(event.target.value)}/>\r\n                        </Form.Group>\r\n                        <p>{isValid_e(e, p, q)}</p>\r\n                        <p>Suggestions: {generate_e(p, q)}</p>\r\n                    </div>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item>\r\n                    <p>\r\n                        <Latex>Public Key Becomes: </Latex>\r\n                    </p>\r\n\r\n                    <p>\r\n                        <Latex>$(e, N) = ($</Latex>\r\n                        {e}\r\n                        <Latex>$, $</Latex>\r\n                        {n}\r\n                        <Latex>$ )$</Latex>\r\n                    </p>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item>\r\n                    <p>\r\n                        The private key, <em>d</em> a modular inverse of <Latex>$e \\ modulo \\ \\phi (n)$</Latex>\r\n                    </p>\r\n                    <p>\r\n                        <Latex>Receiver (decryptor) picks number d:</Latex>\r\n                    </p>\r\n                    {/* Use isValid_d here */}\r\n                    <div className='user-input'>\r\n                        <Form.Group className='form-inline'>\r\n                            <Form.Label>\r\n                                <Latex>$d:\\ $</Latex>\r\n                            </Form.Label>\r\n                            <Form.Control type='number' placeholder='enter d' value={d}\r\n                                          onChange={event => setD(event.target.value)}/>\r\n                        </Form.Group>\r\n                        <p>{isValid_d(d, e, p, q)}</p>\r\n                        <p>Suggestions: {generate_d(e, p, q)}</p>\r\n                    </div>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item>\r\n                    <p>\r\n                        <Latex>The Sender picks a message to encrypt</Latex>\r\n                    </p>\r\n                    <div className='user-input'>\r\n                        <Form.Group className='form-inline'>\r\n                            <Form.Label>\r\n                                <Latex>Message $:\\  $</Latex>\r\n                            </Form.Label>\r\n                            <Form.Control type='text' placeholder='enter message' value={message}\r\n                                          onChange={event => setMessage(event.target.value)}/>\r\n                        </Form.Group>\r\n                    </div>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item>\r\n                    <p>This message is then converted to a number <em>m</em> which is commonly the ASCII encryption (translation) of the message</p>\r\n                    <p>\r\n                        <Latex>$m:\\ $ </Latex>\r\n                    </p>\r\n                    <p>\r\n                        {/* Use ascii_encrypt() here, since we're not rendering anything on screen, we call it as a function */}\r\n                        {ascii_encrypted}\r\n                    </p>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item>\r\n                    <p>\r\n                        <Latex>The Sender sends RSA Encrypted sequence (ciphertext) which is calculated by the following formula </Latex>\r\n                    </p>\r\n                    <p>\r\n                        <Latex>$m^e\\:mod\\:(n)\\:=\\:c$</Latex>\r\n                        {/* Use rsa_encrypt() here, with message = ascii_encrypt() */}\r\n                        <br/>\r\n                        {rsa_encrypted}\r\n                    </p>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item>\r\n                    <p>\r\n                        <Latex>Receiver (decryptor) decrypts ciphertext $c$ and recieves the ASCII ciphered message m, which is calculated by the following formula</Latex>\r\n                    </p>\r\n                    <p>\r\n                        <Latex>$c^d\\:mod\\:(n)\\:=m$</Latex>\r\n                        {/* Use rsa_encrypt() here, with message = ascii_encrypt() */}\r\n                        <br/>\r\n                        {rsa_decrypted}\r\n                    </p>\r\n                </ListGroup.Item>\r\n\r\n                <ListGroup.Item>\r\n                    <p>\r\n                        <Latex>Finally, the receiver calculates the ASCII Decryption and recieves the plaintext original message: </Latex>\r\n                    </p>\r\n                    <p>\r\n                        {/* Use ascii_decrypt() here, with message = m from c^d mod N */}\r\n                        {ascii_decrypted}\r\n                    </p>\r\n                </ListGroup.Item>\r\n            </ListGroup>\r\n        </Page>\r\n    );\r\n};\r\nexport default RsaPage;\r\n","import React from 'react';\r\nimport {Form, Button} from 'react-bootstrap';\r\nimport Page from \"../components/shared/page\";\r\nimport Latex from 'react-latex'\r\n//import bitsToStr from \"../bit-handling-2\";\r\n//import { result } from 'lodash';\r\n\r\n// The cycle for actual bit manipulation\r\nfunction md5cycle(x, k) {\r\n   // The initial variables of the rotates\r\n   var a = x[0], b = x[1], c = x[2], d = x[3];\r\n\r\n   // The rotation amounts specialized to md5\r\n   let rotate_amounts = [7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22,\r\n      5,  9, 14, 20, 5,  9, 14, 20, 5,  9, 14, 20, 5,  9, 14, 20,\r\n      4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23,\r\n      6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21]\r\n\r\n   // Generate the unique sine based values to be factored in\r\n   let K = getDefaults()\r\n\r\n   // The actual looping of md5\r\n   for (let index = 0; index < 64; index++) {\r\n      // F stores the newly computed value\r\n      let F = 0x00000000\r\n      let g = 0\r\n      if (index < 16) {\r\n         g = index\r\n         F = ff(a, b, c, d, k[g], rotate_amounts[index], K[index]);\r\n      }\r\n      else if (index >= 16 && index < 32) {\r\n         g = (5 * index + 1) % 16\r\n         F = gg(a, b, c, d, k[g], rotate_amounts[index], K[index]);\r\n      }\r\n      else if (index >= 32 && index < 48) {\r\n         g = (3 * index + 5) % 16\r\n         F = hh(a, b, c, d, k[g], rotate_amounts[index], K[index]);\r\n      }\r\n      else if (index >= 48) {\r\n         g = (7 * index) % 16\r\n         F = ii(a, b, c, d, k[g], rotate_amounts[index], K[index]);\r\n      }\r\n      // actually rotate them\r\n      a = d\r\n      d = c\r\n      c = b\r\n      b = F\r\n   }\r\n\r\n   // Make sure the addition always take place in 32 bit space\r\n   x[0] = add32(a, x[0]);\r\n   x[1] = add32(b, x[1]);\r\n   x[2] = add32(c, x[2]);\r\n   x[3] = add32(d, x[3]);\r\n\r\n   // Return happens since the values in x are returned\r\n}\r\n\r\n// This does the addditions and rotations of the bits\r\nfunction collect(q, a, b, x, s, t) {\r\n   a = add32(add32(a, q), add32(x, t));\r\n   /// The right shift is to make it a circular shift\r\n   return add32((a << s) | (a >>> (32 - s)), b);\r\n}\r\n\r\n// These are the functions defined by MD5\r\nfunction ff(a, b, c, d, x, s, t) {\r\n   return collect((b & c) | ((~b) & d), a, b, x, s, t);\r\n}\r\n\r\nfunction gg(a, b, c, d, x, s, t) {\r\n   return collect((b & d) | (c & (~d)), a, b, x, s, t);\r\n}\r\n\r\nfunction hh(a, b, c, d, x, s, t) {\r\n   return collect(b ^ c ^ d, a, b, x, s, t);\r\n}\r\n\r\nfunction ii(a, b, c, d, x, s, t) {\r\n   return collect(c ^ (b | (~d)), a, b, x, s, t);\r\n}\r\n\r\n// The quickest way to make sure the result is in 32 bit space\r\nfunction add32(a, b) {\r\n   return (a + b) & 0xFFFFFFFF\r\n}\r\n\r\n// MD5 function to gernerate some seed numbers\r\nfunction getDefaults() {\r\n   let K = []\r\n   for (let i = 0; i < 64; i++) {\r\n      K.push(Math.floor((2 ** 32) * Math.abs(Math.sin(i + 1))))\r\n   }\r\n   return K\r\n}\r\n\r\nfunction makeMD5(s) {\r\n   var n = s.length\r\n   let i\r\n\r\n   // Defined by MD5\r\n   let initials = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476]\r\n   var hash = initials\r\n\r\n   // Loop over the string in 512 bit increments to build the resulting string\r\n   //     64 characters at 8 bits a character is 512\r\n   for (i = 64; i <= n; i += 64) {\r\n      let block = md5block(s.substring(i - 64, i))\r\n      md5cycle(hash, block);\r\n   }\r\n\r\n   // isolate the final string\r\n   s = s.substring(i - 64);\r\n\r\n   // The last block\r\n   var tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n\r\n   // Build the block with the characters in the approapriate form\r\n   //     Lower bits come first\r\n   for (i = 0; i < s.length; i++)\r\n      tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\r\n\r\n   // Set the leading 1 bit of the buffer\r\n   tail[i >> 2] |= 0x80 << ((i % 4) << 3);\r\n\r\n   // If the string took up too much space, make another block essentially\r\n   if (i > 55) {\r\n      md5cycle(hash, tail);\r\n      for (i = 0; i < 16; i++) {\r\n         tail[i] = 0;\r\n      }\r\n   }\r\n\r\n   // describe the size of size of the entire message which goes on the end\r\n   tail[14] = (n * 8) % (2 ** 64);\r\n\r\n   // Hash the last block\r\n   md5cycle(hash, tail);\r\n\r\n   // hash has always been holding the result, so now return it\r\n   return hash;\r\n}\r\n\r\n// Make the md5 blocks\r\nfunction md5block(s) {\r\n   // store the set of blocks as the result, must be 512 \"bits\" in response\r\n   let md5blocks = [];\r\n   for (let i = 0; i < 64; i += 4) {\r\n      // Store first charater in the lowest of the bits\r\n      md5blocks[i >> 2] = s.charCodeAt(i)\r\n         + (s.charCodeAt(i + 1) << 8)\r\n         + (s.charCodeAt(i + 2) << 16)\r\n         + (s.charCodeAt(i + 3) << 24);\r\n   }\r\n   return md5blocks;\r\n}\r\n\r\n// Actually print it in a readable HEX format\r\nfunction makeHex(n) {\r\n   let hex_chr = '0123456789ABCDEF'.split('');\r\n   let s = '';\r\n   for (let index = 0; index < 4; index++)\r\n      s += hex_chr[(n >> (index * 8 + 4)) & 0x0F]\r\n         + hex_chr[(n >> (index * 8)) & 0x0F];\r\n   return s;\r\n}\r\n\r\n// Loop over to join all the appropriate hex values together\r\nfunction hex(x) {\r\n   for (var i = 0; i < x.length; i++)\r\n      x[i] = makeHex(x[i]);\r\n   return x.join('');\r\n}\r\n\r\n// Calls all that is needed to return the text output of MD5\r\nfunction md5(message) {\r\n   return hex(makeMD5(message));\r\n}\r\n\r\n\r\nfunction makeDisplayBlock(s) {\r\n   let n = s.length\r\n   let result = []\r\n   let i;\r\n   // Loop over the string in 512 bit increments to build the resulting string\r\n   //     64 characters at 8 bits a character is 512\r\n   for (i = 64; i <= n; i += 64) {\r\n      let block = md5block(s.substring(i - 64, i))\r\n      result.push(block)\r\n   }\r\n\r\n   // isolate the final string\r\n   s = s.substring(i - 64);\r\n\r\n   // The last block\r\n   var tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n\r\n   // Build the block with the characters in the approapriate form\r\n   //     Lower bits come first\r\n   for (i = 0; i < s.length; i++)\r\n      tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\r\n\r\n   // Set the leading 1 bit of the buffer\r\n   tail[i >> 2] |= 0x80 << ((i % 4) << 3);\r\n\r\n   // If the string took up too much space, make another block essentially\r\n   if (i > 55) {\r\n      result.push(tail)\r\n      for (i = 0; i < 16; i++) {\r\n         tail[i] = 0;\r\n      }\r\n   }\r\n\r\n   // describe the size of size of the entire message which goes on the end\r\n   tail[14] = (n * 8) % (2 ** 64);\r\n\r\n   // Hash the last block\r\n   result.push(tail)\r\n   return(result)\r\n} \r\n\r\nfunction makePretty(arr) {\r\n   let result = \"\"; \r\n   console.log(arr);\r\n   for (let outer = 0; outer < arr.length; outer++) {\r\n      for(let index = 0; index < arr[outer].length; index++) {\r\n         //result += bitsToStr(arr[outer][index])\r\n         result += (arr[outer][index]).toString(2)\r\n         if (index + 1 !== arr[outer].length)\r\n            result += \", \"\r\n      }\r\n   }\r\n   let split_result = result.split(\", \")\r\n   for (let i = 0; i < split_result.length; i++) {\r\n      // make a string of 0s that is 32 - split_result[i].length long\r\n      let zeros = \"\"\r\n      for (let j = split_result[i].length; j < 32; j++) {\r\n         zeros += \"0\"\r\n      }\r\n      split_result[i] = zeros + split_result[i]\r\n   }\r\n   let final_result = \"\";\r\n   for (let i = 0; i < split_result.length; i++) {\r\n      final_result += split_result[i]\r\n      final_result += \", \"\r\n   }\r\n   return final_result.replace(\"-\", \"1\").split(\",\")\r\n\r\n}\r\n\r\n// The cycle for actual bit manipulation\r\nfunction* md5cycleIterations(x, k) {\r\n   // The initial variables of the rotates\r\n   var a = x[0], b = x[1], c = x[2], d = x[3];\r\n\r\n   // The rotation amounts specialized to md5\r\n   let rotate_amounts = [7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22,\r\n      5,  9, 14, 20, 5,  9, 14, 20, 5,  9, 14, 20, 5,  9, 14, 20,\r\n      4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23,\r\n      6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21]\r\n\r\n   // Generate the unique sine based values to be factored in\r\n   let K = getDefaults()\r\n\r\n   // The actual looping of md5\r\n   for (let index = 0; index < 64; index++) {\r\n      // F stores the newly computed value\r\n      let F = 0x00000000\r\n      let g = 0\r\n      if (index < 16) {\r\n         g = index\r\n         F = ff(a, b, c, d, k[g], rotate_amounts[index], K[index]);\r\n      }\r\n      else if (index >= 16 && index < 32) {\r\n         g = (5 * index + 1) % 16\r\n         F = gg(a, b, c, d, k[g], rotate_amounts[index], K[index]);\r\n      }\r\n      else if (index >= 32 && index < 48) {\r\n         g = (3 * index + 5) % 16\r\n         F = hh(a, b, c, d, k[g], rotate_amounts[index], K[index]);\r\n      }\r\n      else if (index >= 48) {\r\n         g = (7 * index) % 16\r\n         F = ii(a, b, c, d, k[g], rotate_amounts[index], K[index]);\r\n      }\r\n      // actually rotate them\r\n      a = d\r\n      d = c\r\n      c = b\r\n      b = F\r\n      let iterum = {'a': a, 'b': b, 'c': c, 'd': d}\r\n      console.log(iterum)\r\n      yield(iterum)\r\n   }\r\n\r\n   // Make sure the addition always take place in 32 bit space\r\n   x[0] = add32(a, x[0]);\r\n   x[1] = add32(b, x[1]);\r\n   x[2] = add32(c, x[2]);\r\n   x[3] = add32(d, x[3]);\r\n\r\n   // Return happens since the values in x are returned\r\n}\r\n\r\nfunction makeASCII(input) {\r\n   var output = \"\"\r\n   for (var i = 0; i < input.length; i++) {\r\n      output += input[i].charCodeAt(0).toString(2) + \" \";\r\n   }\r\n   return output\r\n}\r\n\r\nvar curHash = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476]\r\n\r\n/**\r\n * About Page Wrapper, relies on React Router for routing to here\r\n */\r\nclass Md5Page extends React.Component {\r\n\r\n   constructor(props) {\r\n      super(props);\r\n      let blocks = makeDisplayBlock(\"\")\r\n      this.state = {\r\n         isToggleOn: true,\r\n         message: \"\",\r\n         result: md5(\"\"),\r\n         ascii: \"\",\r\n         cipher: \"\",\r\n         clear: \"\",\r\n         aCur: hex([curHash[0]]),\r\n         bCur: hex([curHash[1]]),\r\n         cCur: hex([curHash[2]]),\r\n         dCur: hex([curHash[3]]),\r\n         iterator: md5cycleIterations(curHash, blocks[0]), \r\n         iteration: 0,\r\n         encodedPretty: makePretty(blocks),\r\n         encoded: blocks,\r\n         warning: \"\",\r\n         numIteration: 0,\r\n         disableButton: true,\r\n      };\r\n\r\n      this.handleFormUpdate = this.handleFormUpdate.bind(this);\r\n      this.handleClick = this.handleClick.bind(this)\r\n   }\r\n\r\n   handleFormUpdate(e) {\r\n      if(e.target.id === \"EncryptUpdate\") {\r\n         let input = e.target.value\r\n         let blocks = makeDisplayBlock(input)\r\n         let initials = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476]\r\n         this.setState({\r\n            message: input,\r\n            result: md5(input),\r\n            ascii: makeASCII(input),\r\n            encodedPretty: makePretty(blocks),\r\n            encoded: blocks,\r\n            aCur: hex([initials[0]]),\r\n            bCur: hex([initials[1]]),\r\n            cCur: hex([initials[2]]),\r\n            dCur: hex([initials[3]]),\r\n            iterator: md5cycleIterations(curHash, blocks[0]),\r\n            iteration: 0,\r\n            warning: \"\",\r\n            numIteration: 0,\r\n            disableButton: false,\r\n         })\r\n      }\r\n   }\r\n\r\n   handleClick(e) {\r\n      let result = this.state.iterator.next().value\r\n      if (result) {\r\n         if (this.state.numIteration !== 63) {\r\n            this.setState({\r\n               aCur: hex([result['a']]),\r\n               bCur: hex([result['b']]),\r\n               cCur: hex([result['c']]),\r\n               dCur: hex([result['d']]),\r\n               numIteration: this.state.numIteration + 1\r\n            }) \r\n         }\r\n         else{\r\n            result = this.state.iterator.next().value\r\n            let temp = JSON.parse(JSON.stringify(curHash))\r\n            //for(let index = 0; index < 4; index++) {\r\n            //   temp.push(curHash[index])\r\n            //}\r\n            console.log(temp)\r\n            this.setState({\r\n               aCur: hex([temp[0]]),\r\n               bCur: hex([temp[1]]),\r\n               cCur: hex([temp[2]]),\r\n               dCur: hex([temp[3]]),\r\n               numIteration: this.state.numIteration + 1,\r\n               //disableButton: true\r\n            })\r\n         }\r\n         \r\n      }\r\n      else {\r\n         let nextIter = this.state.iteration + 1\r\n         if (nextIter < this.state.encoded.length) {\r\n            console.log(this.state.encoded)\r\n            //console.log(md5cycle(curHash, this.state.encoded[nextIter]))\r\n            //for(let i = 0; i < 4; i++) {\r\n            //   console.log(hex(curHash[i]))\r\n           // }\r\n           //console.log(hex(curHash))\r\n            this.setState({\r\n               iterator: md5cycleIterations(curHash, this.state.encoded[nextIter]),\r\n               iteration: nextIter,\r\n               numIteration: 0,\r\n            })\r\n         }\r\n         else {\r\n            this.setState({\r\n               warning: 'Done Encrypting! Enter a new message to iterate again.',\r\n               disableButton: true\r\n            })\r\n         }\r\n      }\r\n   }\r\n\r\n   render() {\r\n      return (\r\n          <Page title=\"MD5\">\r\n             <p>MD5 (or the Fifth Generation of the Message-Digest Algorithm) is a hashing function that yields a 128-bit hash of any length message.</p>\r\n             <Form>\r\n                <Form.Group controlId=\"EncryptUpdate\">\r\n                   <Form.Label><b>Message</b></Form.Label>\r\n                   <Form.Control type=\"text\" onChange={this.handleFormUpdate} placeholder=\"Message to Encrypt\" />\r\n                   <Form.Text className=\"text-muted\">\r\n                      This is the plain text information you want to share.\r\n                   </Form.Text>\r\n                </Form.Group>\r\n                <p><b>ASCII (bit code) Representation of Your Message</b></p>\r\n                <p>{this.state.ascii}</p>\r\n                <hr/>\r\n                <p><b>Resulting MD5 Hash in Hex</b></p>\r\n                <p>{this.state.result}</p>\r\n                <hr/>\r\n                <p><b>How Does it Work?</b></p>\r\n                <p style={{textAlign: 'left'}}>The MD5 algorithm processes the input variable-length message into a resulting fixed-length hash of 128-bits. As shown below, the input message is broken into sixteen 32-bit words\r\n                   based on its ASCII character codes, making chunks of 512-bit blocks.</p>\r\n                <p>{this.state.encodedPretty}</p>\r\n                <p style={{textAlign: 'left'}}>Then, the message is run through a padding technique in which a single one-bit is appended to the end of the message, followed by as many zeros as necessary\r\n                   to bring the length of the message to 64 bits <i>less than</i> a multiple of 512. Then, the remaining bits are filled up with 64 bits representing the length of the\r\n                   original message, modulo <Latex>{'$$2^{64}$$'}</Latex>. This allows the message's length to be fixed to a multiple of 512, conforming to the encryption length necessary.\r\n                </p>\r\n                <p style={{textAlign: 'left'}}>MD5 initially starts with fixed constants for four 32-bit words, shown below as A, B, C, and D. Each 512-bit message block modifies the state through <i>rounds</i>. Each round\r\n                is composed of 16 similar operations reliant on a non-linear function F, modular addition, and left rotation. Each iteration can be stepped through below showing the modification of\r\n                each of the four 32-bit words, represented in hexadecimal below, until the encryption is complete (after 64 iterations, for a total of 65 iterations):</p>\r\n                {this.state.disableButton && <p><i>In order to demonstrate iterations of the MD5 algorithm, you must have a message to encrypt.</i></p>}\r\n                <Button disabled={this.state.disableButton} variant=\"primary\" onClick={this.handleClick}>Iteration</Button>\r\n                <p>A: {this.state.aCur}</p>\r\n                <p>B: {this.state.bCur}</p>\r\n                <p>C: {this.state.cCur}</p>\r\n                <p>D: {this.state.dCur}</p>\r\n                <p>Iteration: {this.state.numIteration}</p>\r\n                <p>Block Number: {this.state.iteration + 1}</p>\r\n                <p>{this.state.warning}</p>\r\n                <br></br>\r\n                <p style={{textAlign: 'left'}}>The result of the function is output into the <b>B</b> variable each iteration. You can see the rest of the variable values are just circularly\r\n                shifted into the following variable (B into C, C into D, and D into A).</p>\r\n                <p style={{textAlign: 'left'}}>Each MD5 operation utilizes one of four possible bitwise functions, and the function shifts after 16 rounds:</p>\r\n                <Latex>{'$$F(B,C,D)=(B \\\\land C) \\\\lor (\\\\lnot B \\\\land D)$$'}</Latex>\r\n                <br/>\r\n                <Latex>{'$$G(B,C,D)=(B \\\\land D) \\\\lor (C \\\\land \\\\lnot D)$$'}</Latex>\r\n                <br/>\r\n                <Latex>{'$$H(B,C,D)=B \\\\oplus C \\\\oplus D$$'}</Latex>\r\n                <br/>\r\n                <Latex>{'$$I(B,C,D)=C \\\\oplus (B \\\\lor \\\\lnot D)$$'}</Latex>\r\n                <p></p>\r\n\r\n             </Form>\r\n          </Page>\r\n      )\r\n   }\r\n}\r\nexport default Md5Page;\r\n","import React, { Component } from 'react'\r\nimport { Route, Switch, HashRouter } from 'react-router-dom';\r\nimport './App.css';\r\nimport Home from './pages/Home'\r\nimport About from './pages/About'\r\nimport VigenerePage from './pages/vigenere-page'\r\nimport DesPage from './pages/des-page'\r\nimport RsaPage from './pages/rsa-page'\r\nimport Md5Page from './pages/md5-page'\r\n\r\nclass App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      login: false,\r\n    };\r\n    this.updateMe = this.updateMe.bind(this)\r\n  }\r\n\r\n  updateMe = (info) => {\r\n    this.setState(info)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"App\">\r\n        <HashRouter basename={process.env.PUBLIC_URL}>\r\n            <Switch>\r\n                <Route path=\"/\" exact render={(props) => <Home {...props} info={this.state} updateMe={this.updateMe}/>}/>\r\n                <Route path=\"/about\" render={(props) => <About {...props} info={this.state} updateMe={this.updateMe}/>}/>\r\n                <Route path=\"/Vigenere\" render={(props) => <VigenerePage {...props} info={this.state} updateMe={this.updateMe}/>}/>\r\n                <Route path=\"/DES\" render={(props) => <DesPage {...props} info={this.state} updateMe={this.updateMe}/>}/>\r\n                <Route path=\"/RSA\" render={(props) => <RsaPage {...props} info={this.state} updateMe={this.updateMe}/>}/>\r\n                <Route path=\"/MD5\" render={(props) => <Md5Page {...props} info={this.state} updateMe={this.updateMe}/>}/>\r\n                <Route component={Error} />\r\n            </Switch>\r\n          </HashRouter>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\n\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}